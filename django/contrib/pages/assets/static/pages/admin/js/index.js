(()=>{"use strict";function e(e){return e.replace(/(?:[_-])([a-z0-9])/g,((e,t)=>t.toUpperCase()))}function t(e){return e.charAt(0).toUpperCase()+e.slice(1)}function r(e){return null!=e}function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function s(e,t){const r=i(e);return Array.from(r.reduce(((e,r)=>(function(e,t){const r=e[t];return Array.isArray(r)?r:[]}(r,t).forEach((t=>e.add(t))),e)),new Set))}function i(e){const t=[];for(;e;)t.push(e),e=Object.getPrototypeOf(e);return t.reverse()}function o(e){return e.reduce(((e,[t,r])=>Object.assign(Object.assign({},e),{[t]:r})),{})}function a(e,t,r){return e.application.getControllerForElementAndIdentifier(t,r)}function u(e,t,r){let n=a(e,t,r);return n||(e.application.router.proposeToConnectScopeForElementAndIdentifier(t,r),n=a(e,t,r),n||void 0)}function c([t,s],i){return function(t){const{token:s,typeDefinition:i}=t,o=`${u=s,u.replace(/([A-Z])/g,((e,t)=>`-${t.toLowerCase()}`))}-value`,a=function(e){const{controller:t,token:n,typeDefinition:s}=e,i=function(e){const{controller:t,token:n,typeObject:s}=e,i=r(s.type),o=r(s.default),a=i&&o,u=i&&!o,c=!i&&o,f=l(s.type),h=p(e.typeObject.default);if(u)return f;if(c)return h;if(f!==h)throw new Error(`The specified default value for the Stimulus Value "${t?`${t}.${n}`:n}" must match the defined type "${f}". The provided default value of "${s.default}" is of type "${h}".`);return a?f:void 0}({controller:t,token:n,typeObject:s}),o=p(s),a=l(s),u=i||o||a;if(u)return u;throw new Error(`Unknown value type "${t?`${t}.${s}`:n}" for "${n}" value`)}(t);var u;return{type:a,key:o,name:e(o),get defaultValue(){return function(e){const t=l(e);if(t)return f[t];const r=n(e,"default"),s=n(e,"type"),i=e;if(r)return i.default;if(s){const{type:e}=i,t=l(e);if(t)return f[t]}return e}(i)},get hasCustomDefaultValue(){return void 0!==p(i)},reader:h[a],writer:d[a]||d.default}}({controller:i,token:t,typeDefinition:s})}function l(e){switch(e){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function p(e){switch(typeof e){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}return Array.isArray(e)?"array":"[object Object]"===Object.prototype.toString.call(e)?"object":void 0}"function"==typeof Object.getOwnPropertySymbols||Object.getOwnPropertyNames,(()=>{function e(e){function t(){return Reflect.construct(e,arguments,new.target)}return t.prototype=Object.create(e.prototype,{constructor:{value:t}}),Reflect.setPrototypeOf(t,e),t}try{return function(){const t=e((function(){this.a.call(this)}));t.prototype.a=function(){},new t}(),e}catch(e){return e=>class extends e{}}})(),Object.assign(Object.assign({enter:"Enter",tab:"Tab",esc:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",home:"Home",end:"End",page_up:"PageUp",page_down:"PageDown"},o("abcdefghijklmnopqrstuvwxyz".split("").map((e=>[e,e])))),o("0123456789".split("").map((e=>[e,e]))));const f={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},h={array(e){const t=JSON.parse(e);if(!Array.isArray(t))throw new TypeError(`expected value of type "array" but instead got value "${e}" of type "${p(t)}"`);return t},boolean:e=>!("0"==e||"false"==String(e).toLowerCase()),number:e=>Number(e.replace(/_/g,"")),object(e){const t=JSON.parse(e);if(null===t||"object"!=typeof t||Array.isArray(t))throw new TypeError(`expected value of type "object" but instead got value "${e}" of type "${p(t)}"`);return t},string:e=>e},d={default:function(e){return`${e}`},array:g,object:g};function g(e){return JSON.stringify(e)}class m{constructor(e){this.context=e}static get shouldLoad(){return!0}static afterLoad(e,t){}get application(){return this.context.application}get scope(){return this.context.scope}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get targets(){return this.scope.targets}get outlets(){return this.scope.outlets}get classes(){return this.scope.classes}get data(){return this.scope.data}initialize(){}connect(){}disconnect(){}dispatch(e,{target:t=this.element,detail:r={},prefix:n=this.identifier,bubbles:s=!0,cancelable:i=!0}={}){const o=new CustomEvent(n?`${n}:${e}`:e,{detail:r,bubbles:s,cancelable:i});return t.dispatchEvent(o),o}}function b(e,t){let r=e.innerHTML;for(const e in t)r=r.replace(`__${e.toUpperCase()}__`,t[e]);const n=document.createElement("div");return n.innerHTML=r,n.firstElementChild}m.blessings=[function(e){return s(e,"classes").reduce(((e,r)=>{return Object.assign(e,(n=r,{[`${n}Class`]:{get(){const{classes:e}=this;if(e.has(n))return e.get(n);{const t=e.getAttributeName(n);throw new Error(`Missing attribute "${t}"`)}}},[`${n}Classes`]:{get(){return this.classes.getAll(n)}},[`has${t(n)}Class`]:{get(){return this.classes.has(n)}}}));var n}),{})},function(e){return s(e,"targets").reduce(((e,r)=>{return Object.assign(e,(n=r,{[`${n}Target`]:{get(){const e=this.targets.find(n);if(e)return e;throw new Error(`Missing target element "${n}" for "${this.identifier}" controller`)}},[`${n}Targets`]:{get(){return this.targets.findAll(n)}},[`has${t(n)}Target`]:{get(){return this.targets.has(n)}}}));var n}),{})},function(e){const r=function(e,t){return i(e).reduce(((e,r)=>(e.push(...function(e,t){const r=e[t];return r?Object.keys(r).map((e=>[e,r[e]])):[]}(r,t)),e)),[])}(e,"values"),n={valueDescriptorMap:{get(){return r.reduce(((e,t)=>{const r=c(t,this.identifier),n=this.data.getAttributeNameForKey(r.key);return Object.assign(e,{[n]:r})}),{})}}};return r.reduce(((e,r)=>Object.assign(e,function(e,r){const n=c(e,void 0),{key:s,name:i,reader:o,writer:a}=n;return{[i]:{get(){const e=this.data.get(s);return null!==e?o(e):n.defaultValue},set(e){void 0===e?this.data.delete(s):this.data.set(s,a(e))}},[`has${t(i)}`]:{get(){return this.data.has(s)||n.hasCustomDefaultValue}}}}(r))),n)},function(r){return s(r,"outlets").reduce(((r,n)=>Object.assign(r,function(r){const n=e(r.replace(/--/g,"-").replace(/__/g,"_"));return{[`${n}Outlet`]:{get(){const e=this.outlets.find(r),t=this.outlets.getSelectorForOutletName(r);if(e){const t=u(this,e,r);if(t)return t;throw new Error(`The provided outlet element is missing an outlet controller "${r}" instance for host controller "${this.identifier}"`)}throw new Error(`Missing outlet element "${r}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${t}".`)}},[`${n}Outlets`]:{get(){const e=this.outlets.findAll(r);return e.length>0?e.map((e=>{const t=u(this,e,r);if(t)return t;console.warn(`The provided outlet element is missing an outlet controller "${r}" instance for host controller "${this.identifier}"`,e)})).filter((e=>e)):[]}},[`${n}OutletElement`]:{get(){const e=this.outlets.find(r),t=this.outlets.getSelectorForOutletName(r);if(e)return e;throw new Error(`Missing outlet element "${r}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${t}".`)}},[`${n}OutletElements`]:{get(){return this.outlets.findAll(r)}},[`has${t(n)}Outlet`]:{get(){return this.outlets.has(r)}}}}(n))),{})}],m.targets=[],m.outlets=[],m.values={};class y extends m{connect(){this.element.menuController=this,this.element.dataset.menuController="true"}toggle(e){this.element.classList.contains("open")?this.close(e):this.open(e)}open(e){this.element.classList.add("open"),this.element.setAttribute("aria-expanded","true"),this.submenuTarget.innerHTML="",fetch(this.urlValue).then((e=>e.json())).then((e=>this.render(e)))}buildMenuItem(e){let t;return t=e.numchild>0?this.templateHasSubpagesTarget:this.templateNoSubpagesTarget,b(t,{id:`page-${e.id}`,label:e.title,page_id:e.id.toString()})}fetchItems(e,t=null){const r=e.dataset.pageId;t=t||{};const n=new URLSearchParams(t);n.set("page_id",r);const s=this.urlValue+"?"+n.toString();fetch(s).then((e=>e.json())).then((e=>{this.submenuTarget.innerHTML="",this.render(e)}))}close(e){this.element.classList.remove("open"),this.element.setAttribute("aria-expanded","false"),this.submenuTarget.innerHTML=""}render(e){if(this.submenuTarget.innerHTML="",e.parent_item){const t=b(this.templateMenuHeaderTarget,{id:`page-${e.parent_item.id}`,label:e.parent_item.title,page_id:e.parent_item.id.toString()});t.addEventListener("click",(e=>{e.preventDefault(),this.fetchItems(t,{get_parent:"true"})})),this.submenuTarget.appendChild(t)}for(const t of e.items){const e=this.buildMenuItem(t);e.addEventListener("click",(t=>{t.preventDefault(),this.fetchItems(e)})),this.submenuTarget.appendChild(e)}}}y.targets=["submenu","templateMenuHeader","templateHasSubpages","templateNoSubpages"],y.values={url:String},window.Stimulus.register("pagemenu",y)})();
# Views Package Documentation

**Note**: This documentation page was (in part) generated by ChatGPT and has been fully reviewed by [Nigel2392](github.com/Nigel2392).

The `views` package provides functionality for caching HTTP responses in a configurable way. This allows for improved performance by reusing previously computed responses instead of recalculating them on each request. The caching mechanism uses a request's headers and URL to generate unique cache keys for each response.

## Functions

### `Cache(view http.Handler, duration cache.Duration, cacheBackends ...string) http.Handler`

The `Cache` function wraps an HTTP handler (`view`) and caches its response for a specified duration. If the same request is made within the cache's duration, the cached response will be returned, improving performance by avoiding unnecessary processing.

```go
func Cache(view http.Handler, duration cache.Duration, cacheBackends ...string) http.Handler
```

- **Parameters**:
  - `view http.Handler`: The HTTP handler whose response will be cached.
  - `duration cache.Duration`: The time-to-live (TTL) for the cached response. If `0` is provided, the response will never expire.
  - `cacheBackends ...string`: Optional cache backends to use. If not provided, the default cache backend will be used.

- **Returns**: An `http.Handler` that can be used like any other HTTP handler.

- **Behavior**:
  1. The cache key is generated using the request's headers and URL.
  2. If a cached response exists:
     - The cached response is returned directly.
  3. If no cached response exists:
     - The view is executed.
     - The response is cached for the specified duration.
     - The response is sent to the client.
  4. In case of an error while caching or retrieving, the handler will log the error and continue with the uncached response.

### Example Usage

```go
import (
    "net/http"
    "time"
    "github.com/Nigel2392/go-django/src/core/cache"
    "github.com/Nigel2392/go-django/src/views"
)

func myView(w http.ResponseWriter, r *http.Request) {
    w.Write([]byte("Hello, World!"))
}

http.Handle("/cached-view", views.Cache(http.HandlerFunc(myView), 10*time.Minute))
http.ListenAndServe(":8080", nil)
```

In this example, the output of `myView` will be cached for 10 minutes. Subsequent requests to `/cached-view` during that time will return the cached response.

## Internal Mechanisms

### `buildRequestCacheKey(req *http.Request) string`

Generates a cache key based on the request's headers and URL. This key is used to uniquely identify a cached response.

- **Parameters**:
  - `req *http.Request`: The HTTP request object.

- **Returns**: A string representing the cache key.

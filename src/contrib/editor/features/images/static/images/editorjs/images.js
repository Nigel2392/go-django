(()=>{"use strict";const t='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrows-fullscreen" viewBox="0 0 16 16">\n\t\x3c!-- The MIT License (MIT) --\x3e\n\t\x3c!-- Copyright (c) 2011-2024 The Bootstrap Authors --\x3e\n    <path fill-rule="evenodd" d="M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707m4.344 0a.5.5 0 0 1 .707 0l4.096 4.096V11.5a.5.5 0 1 1 1 0v3.975a.5.5 0 0 1-.5.5H11.5a.5.5 0 0 1 0-1h2.768l-4.096-4.096a.5.5 0 0 1 0-.707m0-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707m-4.344 0a.5.5 0 0 1-.707 0L1.025 1.732V4.5a.5.5 0 0 1-1 0V.525a.5.5 0 0 1 .5-.5H4.5a.5.5 0 0 1 0 1H1.732l4.096 4.096a.5.5 0 0 1 0 .707"/>\n</svg>',e='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-fullscreen-exit" viewBox="0 0 16 16">\n\t\x3c!-- The MIT License (MIT) --\x3e\n\t\x3c!-- Copyright (c) 2011-2024 The Bootstrap Authors --\x3e\n    <path d="M5.5 0a.5.5 0 0 1 .5.5v4A1.5 1.5 0 0 1 4.5 6h-4a.5.5 0 0 1 0-1h4a.5.5 0 0 0 .5-.5v-4a.5.5 0 0 1 .5-.5m5 0a.5.5 0 0 1 .5.5v4a.5.5 0 0 0 .5.5h4a.5.5 0 0 1 0 1h-4A1.5 1.5 0 0 1 10 4.5v-4a.5.5 0 0 1 .5-.5M0 10.5a.5.5 0 0 1 .5-.5h4A1.5 1.5 0 0 1 6 11.5v4a.5.5 0 0 1-1 0v-4a.5.5 0 0 0-.5-.5h-4a.5.5 0 0 1-.5-.5m10 1a1.5 1.5 0 0 1 1.5-1.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 0-.5.5v4a.5.5 0 0 1-1 0z"/>\n</svg>',i=window.i18n.gettext("Add %s",window.i18n.gettext("Image")),s=window.i18n.gettext("Stretch %s",window.i18n.gettext("Images")),a=window.i18n.gettext("Unstretch %s",window.i18n.gettext("Images"));class n{constructor(t){this.button=t}get classList(){return this.button.classList}set icon(t){let e=this.button.querySelector("svg");e?e.outerHTML=t:this.button.innerHTML=t}}class o{constructor({data:t,api:e,config:i,block:s}){i||(i={}),console.log(t);let a=t.stretched;"defaultStretched"in i&&!("stretched"in t)&&(a=i.defaultStretched),this.data=t||{ids:[],stretched:a},this.data.ids=this.data.ids||[],this.api=e,this.block=s,this.config=i,this.imageWrapper=null}get settings(){return[{name:i,icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">\n                    <path fill-rule="evenodd" d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2"/>\n                </svg>',onClick:function(t,e,i,s){e.chooser.open()}},{name:this.data.stretched?a:s,icon:this.data.stretched?t:e,onClick:function(t,e,i,s){e.data.stretched=!i.stretched,e.block.stretched=e.data.stretched,this.onInit(t,e,i,s)},onInit:function(i,n,o,r){n.data.stretched?(r.classList.add(i.styles.settingsButtonActive),r.icon=e,i.tooltip.onHover(r.button,a)):(r.classList.remove(i.styles.settingsButtonActive),r.icon=t,i.tooltip.onHover(r.button,s))}}]}static get toolbox(){return{title:window.i18n.gettext("Images"),icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-image" viewBox="0 0 16 16">\n\t\x3c!-- The MIT License (MIT) --\x3e\n\t\x3c!-- Copyright (c) 2011-2024 The Bootstrap Authors --\x3e\n    <path stroke="none" stroke-width="0" d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"/>\n    <path stroke="none" stroke-width="0" d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1z"/>\n</svg>'}}static newImage(){let t=document.createElement("div");t.classList.add("GoDjango-images-tool__image-wrapper");var e=document.createElement("img");return e.classList.add("GoDjango-images-tool__image"),t.appendChild(e),t.imageElement=e,t}renderSettings(){const t=document.createElement("div");t.classList.add("GoDjango-images-tool__settings");for(const e of this.settings){let i=new n(document.createElement("button")),s=i.button;s.type="button",s.classList.add(this.api.styles.settingsButton),i.icon=e.icon,this.api.tooltip.onHover(i.button,e.name),e.onInit&&e.onInit(this.api,this,this.data,i),s.addEventListener("click",()=>e.onClick.bind(e)(this.api,this,this.data,i)),t.appendChild(s)}return t}validate(t){return!!t.ids&&t.ids.length>0}render(){if(this.imageWrapper=document.createElement("div"),this.imageWrapper.classList.add("GoDjango-images-tool"),this.chooser=new window.Chooser({title:window.i18n.gettext("Select an image"),listurl:this.config.chooserURL,onChosen:(t,e,i)=>{var s;this.data.ids.push(t);let a=o.newImage();a.imageElement.src=this.config.serveUrl.replace("<<id>>",t),a.imageElement.dataset.id=t,null===(s=this.imageWrapper)||void 0===s||s.appendChild(a)},onClosed:()=>{var t;this.data.ids&&this.data.ids.length||(null===(t=this.imageWrapper)||void 0===t||t.remove(),this.api.blocks.delete(this.api.blocks.getCurrentBlockIndex()))}}),this.data.ids&&this.data.ids.length>0)for(const t of this.data.ids){let e=o.newImage();e.imageElement.src=this.config.serveUrl.replace("<<id>>",t),e.imageElement.dataset.id=t,this.imageWrapper.appendChild(e)}else this.chooser.open();return setTimeout(()=>{this.data.stretched&&(this.block.stretched=!0)}),this.imageWrapper}save(t){let e=this.api.blocks.getCurrentBlockIndex();if(!t&&e>-1)return this.api.blocks.delete(e),{ids:[],stretched:this.block.stretched};const i=t.querySelectorAll("img");var s=[];return i.forEach(t=>{s.push(t.dataset.id)}),{ids:s,stretched:this.block.stretched||!1}}}window.GoDjangoImagesTool=o})();
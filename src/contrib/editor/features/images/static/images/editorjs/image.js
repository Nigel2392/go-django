(()=>{"use strict";window.GoDjangoImageTool=class{constructor({data:t,api:i,config:e,block:a}){e||(e={}),this.data=t,this.api=i,this.block=a,this.config=e,this.imageWrapper=null}static get toolbox(){return{title:window.i18n.gettext("Image"),icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-image" viewBox="0 0 16 16">\n\t\x3c!-- The MIT License (MIT) --\x3e\n\t\x3c!-- Copyright (c) 2011-2024 The Bootstrap Authors --\x3e\n    <path stroke="none" stroke-width="0" d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"/>\n    <path stroke="none" stroke-width="0" d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1z"/>\n</svg>'}}validate(t){return!!t.id}render(){return this.imageWrapper=document.createElement("div"),this.imageWrapper.classList.add("GoDjango-image-tool"),this.image=document.createElement("img"),this.image.classList.add(this.api.styles.block,"GoDjango-image-tool__image"),this.chooser=new window.Chooser({title:window.i18n.gettext("Select an image"),listurl:this.config.chooserURL,onChosen:(t,i,e)=>{this.data.id=t,this.data.caption=e.caption,this.image.src=this.config.serveUrl.replace("<<id>>",t),this.image.alt=e.caption,this.image.dataset.id=t},onClosed:()=>{var t;this.data.id||(null===(t=this.imageWrapper)||void 0===t||t.remove(),this.api.blocks.delete(this.api.blocks.getCurrentBlockIndex()))}}),this.data.id?(this.image.src=this.config.serveUrl.replace("<<id>>",this.data.id),this.image.alt=this.data.caption||"",this.image.dataset.id=this.data.id,this.image.dataset.caption=this.data.caption||""):this.chooser.open(),this.image.style.cursor="pointer",this.api.tooltip.onHover(this.image,window.i18n.gettext("CTRL + Click to change image"),{placement:"top"}),this.image.addEventListener("click",t=>{t.ctrlKey&&this.chooser.open()}),this.imageWrapper.appendChild(this.image),this.imageWrapper}save(t){let i=this.api.blocks.getCurrentBlockIndex();if(!t&&i>-1)return void this.api.blocks.delete(i);const e=t.querySelector("img");return{id:e.dataset.id,caption:e.alt}}}})();
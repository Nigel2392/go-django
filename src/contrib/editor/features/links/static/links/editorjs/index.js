(()=>{"use strict";var t={56:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},72:t=>{var e=[];function n(t){for(var n=-1,o=0;o<e.length;o++)if(e[o].identifier===t){n=o;break}return n}function o(t,o){for(var s={},r=[],a=0;a<t.length;a++){var l=t[a],c=o.base?l[0]+o.base:l[0],d=s[c]||0,h="".concat(c," ").concat(d);s[c]=d+1;var p=n(h),g={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)e[p].references++,e[p].updater(g);else{var u=i(g,o);o.byIndex=a,e.splice(a,0,{identifier:h,updater:u,references:1})}r.push(h)}return r}function i(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var s=o(t=t||[],i=i||{});return function(t){t=t||[];for(var r=0;r<s.length;r++){var a=n(s[r]);e[a].references--}for(var l=o(t,i),c=0;c<s.length;c++){var d=n(s[c]);0===e[d].references&&(e[d].updater(),e.splice(d,1))}s=l}}},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n="",o=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),o&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),o&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n}).join("")},e.i=function(t,n,o,i,s){"string"==typeof t&&(t=[[null,t,void 0]]);var r={};if(o)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(r[l]=!0)}for(var c=0;c<t.length;c++){var d=[].concat(t[c]);o&&r[d[0]]||(void 0!==s&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=s),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),i&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=i):d[4]="".concat(i)),e.push(d))}},e}},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},601:(t,e,n)=>{n.d(e,{A:()=>a});var o=n(982),i=n.n(o),s=n(314),r=n.n(s)()(i());r.push([t.id,".page-link {\n    color: #2e1f5e;\n    cursor: pointer;\n}\n.page-link:hover {\n    color: #362377;\n}\n.page-link-modal-overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.375);\n    z-index: 1000;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n.page-link-modal-overlay[hidden] {\n    display: none;\n}\n.page-link-modal {\n    /* margin-top: -4rem; */\n    position: relative;\n    background-color: white;\n    border-radius: 4px;\n    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n    padding: 1.5rem;\n    max-width: min(100%, 52em);\n    width: 100%;\n}\n.page-link-modal-controls {\n    position: absolute;\n    top: 0.5rem;\n    right: 0.5rem;\n}\n.page-link-modal-control {\n    background-color: transparent;\n    border: 1px solid rgba(0, 0, 0, 0.15);\n    border-radius: 4px;\n    cursor: pointer;\n    display: inline-block;\n    height: 1.5rem;\n    width: 1.5rem;\n    text-align: center;\n    line-height: 1.5rem;\n}\n.page-link-modal-control + .page-link-modal-control {\n    margin-left: 0.5rem;\n}\n.page-link-modal-close {\n    position: relative;\n    color: #ff0000;\n}\n.page-link-modal-close-x {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n}\n.page-link-modal-close:hover {\n    color: #ffffff;\n    background-color: #ff0000;\n}\n.page-link-modal-heading {\n    margin: 0;\n    color: #2e1f5e;\n}\n.page-link-modal-heading > * {\n    font-size: 2.25rem;\n    font-weight: bold;\n}\n.page-link-modal-content {\n    display: flex;\n    flex-direction: column;\n}\n.page-link-modal-parent-page,\n.page-link-modal-page {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    padding: 0.5rem 0;\n    border-bottom: 1px solid rgba(0, 0, 0, 0.05);\n}\n.page-link-modal-parent-page-heading,\n.page-link-modal-page-heading {\n    margin: 0;\n    font-size: 1.25rem;\n    font-weight: 500;\n    color: #2e1f5e;\n    cursor: pointer;\n}\n.page-link-modal-parent-page-heading {\n    font-size: 2rem;\n    font-weight: 500;\n}\n.page-link-modal-page-down,\n.page-link-modal-parent-page-pageup {\n    display: flex;\n    cursor: pointer;\n    vertical-align: middle;\n}\n.page-link-modal-page-down {\n    margin-left: auto;\n}\n.page-link-modal-page-down svg,\n.page-link-modal-parent-page-pageup svg {\n    vertical-align: middle;\n    color: #2e1f5e;\n}\n.page-link-modal-page-down svg {\n    width: 1.5rem;\n    height: 1.5rem;\n}\n.page-link-modal-parent-page-pageup {\n    margin-right: 1rem;\n}\n.page-link-modal-parent-page-pageup svg {\n    width: 2rem;\n    height: 2rem;\n}\n\n.page-link-modal-loader{\n  width: 100%;\n  height: 3px;\n  background-color: #2e1f5e;\n  position: absolute;\n  left: 5%;\n  right: 5%;\n  max-width: 90%;\n  animation: line 2s infinite alternate;\n}\n@keyframes line{\n  0%{\n      transform: scaleX(0);\n      transform-origin: left;\n  }\n  45%{\n      transform: scaleX(1);\n      transform-origin: left;\n  }\n  50%{\n      transform: scaleX(1);\n      transform-origin: right;\n  }\n  55%{\n      transform: scaleX(1);\n      transform-origin: right;\n  }\n  100%{\n      transform: scaleX(0);\n      transform-origin: right;\n  }\n}\n  ",""]);const a=r},659:t=>{var e={};t.exports=function(t,n){var o=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var o="";n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,i&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(o,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},982:t=>{t.exports=function(t){return t[1]}}},e={};function n(o){var i=e[o];if(void 0!==i)return i.exports;var s=e[o]={id:o,exports:{}};return t[o](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0;var o=n(72),i=n.n(o),s=n(825),r=n.n(s),a=n(659),l=n.n(a),c=n(56),d=n.n(c),h=n(540),p=n.n(h),g=n(113),u=n.n(g),m=n(601),f={};f.styleTagTransform=u(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=r(),f.insertStyleElement=p(),i()(m.A,f),m.A&&m.A.locals&&m.A.locals;const v=new Set(["svg","path","circle","rect","g","defs","clipPath","use","line","polygon","polyline","ellipse","text","tspan","marker","pattern","mask","symbol","view"]);function w(t,e,...n){if("function"==typeof t)return t(null!=e?e:{},n);const o=v.has(t),i=o?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t);if(e)for(const[t,n]of Object.entries(e))if("class"===t)i.setAttribute("class",n);else if("style"===t&&"object"==typeof n)Object.assign(i.style,n);else if(t.startsWith("on")&&"function"==typeof n){const e=t.slice(2).toLowerCase();i.addEventListener(e,n)}else o?i.setAttribute(t,n):t in i?i[t]=n:i.setAttribute(t,n);const s=t=>{"string"==typeof t?i.appendChild(document.createTextNode(t)):t instanceof Node?i.appendChild(t):Array.isArray(t)?t.forEach(s):console.warn("Invalid child type:",t)};return n.forEach(s),i}class y{constructor(t){this._dialog=null,this._controls=null,this._title=null,this._content=null,this._footer=null,this.root=t}get dialog(){return this._dialog||(this._dialog=this.root.querySelector("dialog")),this._dialog}get controls(){return this._controls||(this._controls=this.root.querySelector(".godjango-modal-controls")),this._controls}get title(){return this._title||(this._title=this.root.querySelector(".godjango-modal-header")),this._title}get content(){return this._content||(this._content=this.root.querySelector(".godjango-modal-content")),this._content}get footer(){return this._footer||(this._footer=this.root.querySelector(".godjango-modal-footer")),this._footer}}function b(t,e,n){return new CustomEvent("modal:"+t,{detail:{action:t,modal:e,originalEvent:n}})}class k{constructor(t,e={}){let n=t;n.modal=this,n.dataset.modal="true",this.options=e,this.connect(n),this.options.opened&&this.open()}actions(){return{close:this.close.bind(this),resize:t=>{this.elements.dialog.toggleAttribute("fullscreen")}}}executeAction(t){const e=this.actions();e[t]?e[t]():console.warn(`No action defined for ${t} in modal controls.`)}connect(t){this.elements=new y(t),this.elements.modal=w("div",{class:"godjango-modal-wrapper"},w("dialog",{class:"godjango-modal"},w("div",{class:"godjango-modal-controls",id:"modal-controls"},w("button",{class:"godjango-modal-control godjango-modal-controls-modal-size",id:"modal-controls-size","data-action":"resize",type:"button"},w("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"godjango-modal-controls-icon",viewBox:"0 0 16 16"},w("path",{d:"M0 3.5A1.5 1.5 0 0 1 1.5 2h13A1.5 1.5 0 0 1 16 3.5v9a1.5 1.5 0 0 1-1.5 1.5h-13A1.5 1.5 0 0 1 0 12.5zM1.5 3a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h13a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5z"}),w("path",{d:"M2 4.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1H3v2.5a.5.5 0 0 1-1 0zm12 7a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1 0-1H13V8.5a.5.5 0 0 1 1 0z"}))),w("button",{class:"godjango-modal-control godjango-modal-controls-modal-close",id:"modal-controls-close","data-action":"close",type:"button"},w("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"godjango-modal-controls-icon",viewBox:"0 0 16 16"},w("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"})))),w("div",{class:"godjango-modal-header",id:"modal-title"}),w("div",{class:"godjango-modal-content",id:"modal-content"}),w("div",{class:"godjango-modal-footer",id:"modal-footer"}))),this.elements.root.appendChild(this.elements.modal),this.documentClickListener=t=>{console.debug("Modal document click listener",t.target),t.target instanceof HTMLElement&&!this.elements.dialog.contains(t.target)&&this.close(t)};const e=this.elements.controls.querySelectorAll("[data-action]"),n=this.actions();e.forEach(t=>{const e=t.dataset.action;e&&n[e]?t.addEventListener("click",t=>{t.preventDefault(),n[e](t)}):console.warn(`No action defined for ${e} in modal controls.`)})}disconnect(){this.elements.root.modal=null,this.elements.modal&&this.elements.root.removeChild(this.elements.modal)}open(t){this.elements.dialog?this.elements.dialog.open?console.warn("Modal is already open."):(this.elements.dialog.showModal(),this.elements.root.dispatchEvent(b("modal:open",this,t)),setTimeout(()=>{this.elements.modal.addEventListener("click",this.documentClickListener)}),this.options.onOpen&&this.options.onOpen(t)):console.warn("Modal dialog element not found.")}close(t){this.elements.dialog?this.elements.dialog.open?(this.elements.dialog.close(),this.elements.root.dispatchEvent(b("modal:close",this,t)),this.elements.root.removeEventListener("click",this.documentClickListener),this.options.onClose&&this.options.onClose(t)):console.warn("Modal is not open."):console.warn("Modal dialog element not found.")}set controls(t){"string"==typeof t?this.executeAction(t):t instanceof HTMLElement?(this.elements.controls.innerHTML="",this.elements.controls.appendChild(t)):console.warn("Invalid controls value:",t)}set title(t){"string"==typeof t?this.elements.title.innerHTML=t:t instanceof HTMLElement?(this.elements.title.innerHTML="",this.elements.title.appendChild(t)):console.warn("Invalid title value:",t)}set content(t){"string"==typeof t?this.elements.content.innerHTML=t:t instanceof HTMLElement?(this.elements.content.innerHTML="",this.elements.content.appendChild(t)):console.warn("Invalid content value:",t),this.options.executeScriptsOnSet&&this.elements.content.querySelectorAll("script").forEach(t=>{const e=document.createElement("script");e.dataset.initialized="true",[...t.attributes].forEach(t=>e.setAttribute(t.name,t.value)),t.textContent&&(e.textContent=t.textContent),t.parentNode.replaceChild(e,t)})}get root(){return this.elements.root}get dialog(){return this.elements.dialog}get controls(){return this.elements.controls}get title(){return this.elements.title}get content(){return this.elements.content}get footer(){return this.elements.footer}}var x=function(t,e,n,o){return new(n||(n=Promise))(function(i,s){function r(t){try{l(o.next(t))}catch(t){s(t)}}function a(t){try{l(o.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(r,a)}l((o=o.apply(t,e||[])).next())})};class C{constructor(t){this.config=t,this.config.modalClass||(this.config.modalClass="godjango-modal-wrapper"),this.modalWrapper=document.getElementById(this.config.modalClass),this.modalWrapper||(this.modalWrapper=document.createElement("div"),this.modalWrapper.id=this.config.modalClass,this.modalWrapper.className=this.config.modalClass,document.body.appendChild(this.modalWrapper))}disconnect(){this.modal=null,this.modal.disconnect()}fetch(t){return x(this,arguments,void 0,function*(t,e="GET",n,o){const i={method:e,headers:Object.assign({Accept:"application/json"},o)};n&&"GET"!==i.method.toUpperCase()&&(i.body=n instanceof FormData?n:JSON.stringify(n));const s=new Request(t,i),r=yield fetch(s);if(!r.ok)throw new Error(`Failed to fetch ${t}: ${r.statusText}`);var a=yield r.json();if(!a.html&&!a.pk&&!a.preview)throw new Error(`Invalid response from ${t}: missing html in ${Object.keys(a)}`);if(a.errors&&a.errors.length>0)for(const e of a.errors)console.error(`Error from ${t}:`,e);return a})}get searchForm(){return this.modal.content.querySelector(".godjango-chooser-list-form")}loadModalContent(t){return x(this,arguments,void 0,function*(t,e="GET",n,o){console.debug("Loading modal content from:",t);try{const i=yield this.fetch(t,e,n,o);if(i.pk)return i;this.modal.content=i.html}catch(t){console.error("Error loading modal content:",t)}return null})}select(t,e,n){this.config.onChosen?this.config.onChosen(t,e,n):console.error("Chooser onChosen callback is not defined")}setup(){return x(this,void 0,void 0,function*(){this.modal.title=`<h1>${this.config.title}</h1>`,yield this.showList()})}teardown(){return x(this,void 0,void 0,function*(){this.modal.disconnect()})}open(){return x(this,void 0,void 0,function*(){this.modal=new k(this.modalWrapper,{opened:!0,executeScriptsOnSet:!0,onOpen:()=>{this.config.onOpen&&this.config.onOpen()},onClose:t=>x(this,void 0,void 0,function*(){yield this.teardown(),this.config.onClosed&&this.config.onClosed()})}),yield this.setup()})}close(){return x(this,void 0,void 0,function*(){this.modal.close(),yield this.teardown()})}showList(){return x(this,arguments,void 0,function*(t=this.config.listurl){yield this.loadModalContent(t),this.modal.content.querySelectorAll(".godjango-chooser-list-group").forEach(t=>{t.addEventListener("click",e=>{if(e.target.classList.contains("chooser-list-link")||e.target.closest(".chooser-list-link"))console.debug("Clicked on link inside chooser row, ignoring row click");else{e.stopPropagation(),e.preventDefault();var n=t.dataset.chooserValue,o=t.dataset.chooserPreview;this.select(n,o,JSON.parse(t.dataset.chooserData||"{}")),this.close()}})}),this.searchForm&&this.searchForm.addEventListener("submit",t=>x(this,void 0,void 0,function*(){t.preventDefault();const e=new FormData(this.searchForm),n=new URLSearchParams(e),o=`${this.config.listurl}?${n.toString()}`;yield this.showList(o)})),this.modal.content.querySelectorAll(".pagination a, .chooser-list-link").forEach(t=>{t.addEventListener("click",e=>x(this,void 0,void 0,function*(){e.preventDefault();const n=t.getAttribute("href");n?yield this.showList(n):console.warn("Chooser link has no href:",t)}))});var e=this.modal.content.querySelector(".godjango-chooser-list-create a");e&&e.addEventListener("click",t=>x(this,void 0,void 0,function*(){t.preventDefault();let n=this.config.createurl||e.href;yield this.showCreate(n)}))})}showCreate(){return x(this,arguments,void 0,function*(t=this.config.createurl,e="GET",n=null){let o=yield this.loadModalContent(t,e,n);if(o)return this.select(o.pk,o.preview,o.data),void(yield this.close());this.modal.content.querySelector("#back-to-list").addEventListener("click",t=>x(this,void 0,void 0,function*(){t.preventDefault(),yield this.showList()}));const i=this.modal.content.querySelector("form");i.addEventListener("submit",e=>x(this,void 0,void 0,function*(){e.preventDefault();const n=new FormData(i);yield this.showCreate(t,"POST",n)}))})}}window.PageLinkTool=class{constructor({data:t,api:e,config:n}){if(n||(n={}),this.tag="A",this.tagClass="page-link",this.data=t,this.api=e,this.config=n,!this.config.pageListURL||!this.config.pageViewURL)throw new Error("PageLinkTool requires pageListURL and pageViewURL in config")}static get isInline(){return!0}static get sanitize(){return{a:!0}}set state(t){this._state=t,this.button.classList.toggle(this.api.styles.inlineToolButtonActive,t)}get state(){return this._state}validate(t){return!!(t&&t.id&&t.text)&&""!==t.id.trim()&&""!==t.text.trim()}surround(t){this.state?this.unwrap(t):(this.chooser.config.onChosen=(e,n)=>{this.wrap(t,e,n)},this.chooser.open())}wrap(t,e,n){let o=t.extractContents();const i=this.api.selection.findParentTag(this.tag);(i||i&&i.querySelector(this.tag.toLowerCase()))&&i.remove(),this.wrapperTag=document.createElement(this.tag),this.wrapperTag.dataset.pageId=e,this.wrapperTag.href=this.config.pageViewURL.replace("<<id>>",e),this.wrapperTag.classList.add(this.tagClass),this.wrapperTag.appendChild(o),t.insertNode(this.wrapperTag),this.api.selection.expandToTag(this.wrapperTag)}unwrap(t){const e=this.api.selection.findParentTag(this.tag),n=t.extractContents();e.remove(),t.insertNode(n)}render(){return this.button=document.createElement("button"),this.button.type="button",this.button.classList.add(this.api.styles.inlineToolButton),this.button.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link-45deg" viewBox="0 0 16 16">\n  <path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1 1 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4 4 0 0 1-.128-1.287z"/>\n  <path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243z"/>\n</svg>',this.chooser=new C({title:window.i18n.gettext("Select a page"),listurl:this.config.pageListURL}),this.button}checkState(){const t=this.api.selection.findParentTag(this.tag,this.tagClass);this.state=!!t}save(t){const e=t.querySelector("a");return{id:e.dataset.id,text:e.innerText}}}})();
/*! For license information please see index.js.LICENSE.txt */
(()=>{"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function t(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?e(Object(o),!0).forEach(function(e){i(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},o.apply(this,arguments)}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function a(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var l=a(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),s=a(/Edge/i),c=a(/firefox/i),d=a(/safari/i)&&!a(/chrome/i)&&!a(/android/i),u=a(/iP(ad|od|hone)/i),h=a(/chrome/i)&&a(/android/i),p={capture:!1,passive:!1};function f(e,t,n){e.addEventListener(t,n,!l&&p)}function g(e,t,n){e.removeEventListener(t,n,!l&&p)}function m(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}}function v(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function b(e,t,n,i){if(e){n=n||document;do{if(null!=t&&(">"===t[0]?e.parentNode===n&&m(e,t):m(e,t))||i&&e===n)return e;if(e===n)break}while(e=v(e))}return null}var y,w=/\s+/g;function k(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var i=(" "+e.className+" ").replace(w," ").replace(" "+t+" "," ");e.className=(i+(n?" "+t:"")).replace(w," ")}}function E(e,t,n){var i=e&&e.style;if(i){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];t in i||-1!==t.indexOf("webkit")||(t="-webkit-"+t),i[t]=n+("string"==typeof n?"":"px")}}function S(e,t){var n="";if("string"==typeof e)n=e;else do{var i=E(e,"transform");i&&"none"!==i&&(n=i+" "+n)}while(!t&&(e=e.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(n)}function C(e,t,n){if(e){var i=e.getElementsByTagName(t),o=0,r=i.length;if(n)for(;o<r;o++)n(i[o],o);return i}return[]}function D(){return document.scrollingElement||document.documentElement}function _(e,t,n,i,o){if(e.getBoundingClientRect||e===window){var r,a,s,c,d,u,h;if(e!==window&&e.parentNode&&e!==D()?(a=(r=e.getBoundingClientRect()).top,s=r.left,c=r.bottom,d=r.right,u=r.height,h=r.width):(a=0,s=0,c=window.innerHeight,d=window.innerWidth,u=window.innerHeight,h=window.innerWidth),(t||n)&&e!==window&&(o=o||e.parentNode,!l))do{if(o&&o.getBoundingClientRect&&("none"!==E(o,"transform")||n&&"static"!==E(o,"position"))){var p=o.getBoundingClientRect();a-=p.top+parseInt(E(o,"border-top-width")),s-=p.left+parseInt(E(o,"border-left-width")),c=a+r.height,d=s+r.width;break}}while(o=o.parentNode);if(i&&e!==window){var f=S(o||e),g=f&&f.a,m=f&&f.d;f&&(c=(a/=m)+(u/=m),d=(s/=g)+(h/=g))}return{top:a,left:s,bottom:c,right:d,width:h,height:u}}}function x(e,t,n){for(var i=M(e,!0),o=_(e)[t];i;){var r=_(i)[n];if(!("top"===n||"left"===n?o>=r:o<=r))return i;if(i===D())break;i=M(i,!1)}return!1}function A(e,t,n,i){for(var o=0,r=0,a=e.children;r<a.length;){if("none"!==a[r].style.display&&a[r]!==Be.ghost&&(i||a[r]!==Be.dragged)&&b(a[r],n.draggable,e,!1)){if(o===t)return a[r];o++}r++}return null}function T(e,t){for(var n=e.lastElementChild;n&&(n===Be.ghost||"none"===E(n,"display")||t&&!m(n,t));)n=n.previousElementSibling;return n||null}function I(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===Be.clone||t&&!m(e,t)||n++;return n}function O(e){var t=0,n=0,i=D();if(e)do{var o=S(e),r=o.a,a=o.d;t+=e.scrollLeft*r,n+=e.scrollTop*a}while(e!==i&&(e=e.parentNode));return[t,n]}function M(e,t){if(!e||!e.getBoundingClientRect)return D();var n=e,i=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var o=E(n);if(n.clientWidth<n.scrollWidth&&("auto"==o.overflowX||"scroll"==o.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==o.overflowY||"scroll"==o.overflowY)){if(!n.getBoundingClientRect||n===document.body)return D();if(i||t)return n;i=!0}}}while(n=n.parentNode);return D()}function N(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function q(e,t){return function(){if(!y){var n=arguments;1===n.length?e.call(this,n[0]):e.apply(this,n),y=setTimeout(function(){y=void 0},t)}}}function P(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function $(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}function L(e,t){E(e,"position","absolute"),E(e,"top",t.top),E(e,"left",t.left),E(e,"width",t.width),E(e,"height",t.height)}function B(e){E(e,"position",""),E(e,"top",""),E(e,"left",""),E(e,"width",""),E(e,"height","")}function j(e,t,n){var i={};return Array.from(e.children).forEach(function(o){var r,a,l,s;if(b(o,t.draggable,e,!1)&&!o.animated&&o!==n){var c=_(o);i.left=Math.min(null!==(r=i.left)&&void 0!==r?r:1/0,c.left),i.top=Math.min(null!==(a=i.top)&&void 0!==a?a:1/0,c.top),i.right=Math.max(null!==(l=i.right)&&void 0!==l?l:-1/0,c.right),i.bottom=Math.max(null!==(s=i.bottom)&&void 0!==s?s:-1/0,c.bottom)}}),i.width=i.right-i.left,i.height=i.bottom-i.top,i.x=i.left,i.y=i.top,i}var W="Sortable"+(new Date).getTime();var F=[],R={initializeByDefault:!0},Y={mount:function(e){for(var t in R)R.hasOwnProperty(t)&&!(t in e)&&(e[t]=R[t]);F.forEach(function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),F.push(e)},pluginEvent:function(e,n,i){var o=this;this.eventCanceled=!1,i.cancel=function(){o.eventCanceled=!0};var r=e+"Global";F.forEach(function(o){n[o.pluginName]&&(n[o.pluginName][r]&&n[o.pluginName][r](t({sortable:n},i)),n.options[o.pluginName]&&n[o.pluginName][e]&&n[o.pluginName][e](t({sortable:n},i)))})},initializePlugins:function(e,t,n,i){for(var r in F.forEach(function(i){var r=i.pluginName;if(e.options[r]||i.initializeByDefault){var a=new i(e,t,e.options);a.sortable=e,a.options=e.options,e[r]=a,o(n,a.defaults)}}),e.options)if(e.options.hasOwnProperty(r)){var a=this.modifyOption(e,r,e.options[r]);void 0!==a&&(e.options[r]=a)}},getEventProperties:function(e,t){var n={};return F.forEach(function(i){"function"==typeof i.eventProperties&&o(n,i.eventProperties.call(t[i.pluginName],e))}),n},modifyOption:function(e,t,n){var i;return F.forEach(function(o){e[o.pluginName]&&o.optionListeners&&"function"==typeof o.optionListeners[t]&&(i=o.optionListeners[t].call(e[o.pluginName],n))}),i}};function X(e){var n=e.sortable,i=e.rootEl,o=e.name,r=e.targetEl,a=e.cloneEl,c=e.toEl,d=e.fromEl,u=e.oldIndex,h=e.newIndex,p=e.oldDraggableIndex,f=e.newDraggableIndex,g=e.originalEvent,m=e.putSortable,v=e.extraEventProperties;if(n=n||i&&i[W]){var b,y=n.options,w="on"+o.charAt(0).toUpperCase()+o.substr(1);!window.CustomEvent||l||s?(b=document.createEvent("Event")).initEvent(o,!0,!0):b=new CustomEvent(o,{bubbles:!0,cancelable:!0}),b.to=c||i,b.from=d||i,b.item=r||i,b.clone=a,b.oldIndex=u,b.newIndex=h,b.oldDraggableIndex=p,b.newDraggableIndex=f,b.originalEvent=g,b.pullMode=m?m.lastPutMode:void 0;var k=t(t({},v),Y.getEventProperties(o,n));for(var E in k)b[E]=k[E];i&&i.dispatchEvent(b),y[w]&&y[w].call(n,b)}}var V=["evt"],H=function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=i.evt,r=function(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(i,V);Y.pluginEvent.bind(Be)(e,n,t({dragEl:z,parentEl:G,ghostEl:U,rootEl:Z,nextEl:J,lastDownEl:Q,cloneEl:ee,cloneHidden:te,dragStarted:fe,putSortable:le,activeSortable:Be.active,originalEvent:o,oldIndex:ne,oldDraggableIndex:oe,newIndex:ie,newDraggableIndex:re,hideGhostForTarget:qe,unhideGhostForTarget:Pe,cloneNowHidden:function(){te=!0},cloneNowShown:function(){te=!1},dispatchSortableEvent:function(e){K({sortable:n,name:e,originalEvent:o})}},r))};function K(e){X(t({putSortable:le,cloneEl:ee,targetEl:z,rootEl:Z,oldIndex:ne,oldDraggableIndex:oe,newIndex:ie,newDraggableIndex:re},e))}var z,G,U,Z,J,Q,ee,te,ne,ie,oe,re,ae,le,se,ce,de,ue,he,pe,fe,ge,me,ve,be,ye=!1,we=!1,ke=[],Ee=!1,Se=!1,Ce=[],De=!1,_e=[],xe="undefined"!=typeof document,Ae=u,Te=s||l?"cssFloat":"float",Ie=xe&&!h&&!u&&"draggable"in document.createElement("div"),Oe=function(){if(xe){if(l)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Me=function(e,t){var n=E(e),i=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),o=A(e,0,t),r=A(e,1,t),a=o&&E(o),l=r&&E(r),s=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+_(o).width,c=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+_(r).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&a.float&&"none"!==a.float){var d="left"===a.float?"left":"right";return!r||"both"!==l.clear&&l.clear!==d?"horizontal":"vertical"}return o&&("block"===a.display||"flex"===a.display||"table"===a.display||"grid"===a.display||s>=i&&"none"===n[Te]||r&&"none"===n[Te]&&s+c>i)?"vertical":"horizontal"},Ne=function(e){function t(e,n){return function(i,o,r,a){var l=i.options.group.name&&o.options.group.name&&i.options.group.name===o.options.group.name;if(null==e&&(n||l))return!0;if(null==e||!1===e)return!1;if(n&&"clone"===e)return e;if("function"==typeof e)return t(e(i,o,r,a),n)(i,o,r,a);var s=(n?i:o).options.group.name;return!0===e||"string"==typeof e&&e===s||e.join&&e.indexOf(s)>-1}}var i={},o=e.group;o&&"object"==n(o)||(o={name:o}),i.name=o.name,i.checkPull=t(o.pull,!0),i.checkPut=t(o.put),i.revertClone=o.revertClone,e.group=i},qe=function(){!Oe&&U&&E(U,"display","none")},Pe=function(){!Oe&&U&&E(U,"display","")};xe&&!h&&document.addEventListener("click",function(e){if(we)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),we=!1,!1},!0);var $e=function(e){if(z){e=e.touches?e.touches[0]:e;var t=(o=e.clientX,r=e.clientY,ke.some(function(e){var t=e[W].options.emptyInsertThreshold;if(t&&!T(e)){var n=_(e),i=o>=n.left-t&&o<=n.right+t,l=r>=n.top-t&&r<=n.bottom+t;return i&&l?a=e:void 0}}),a);if(t){var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);n.target=n.rootEl=t,n.preventDefault=void 0,n.stopPropagation=void 0,t[W]._onDragOver(n)}}var o,r,a},Le=function(e){z&&z.parentNode[W]._isOutsideThisEl(e.target)};function Be(e,n){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=n=o({},n),e[W]=this;var i,r,a={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Me(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Be.supportPointer&&"PointerEvent"in window&&!d,emptyInsertThreshold:5};for(var l in Y.initializePlugins(this,e,a),a)!(l in n)&&(n[l]=a[l]);for(var s in Ne(n),this)"_"===s.charAt(0)&&"function"==typeof this[s]&&(this[s]=this[s].bind(this));this.nativeDraggable=!n.forceFallback&&Ie,this.nativeDraggable&&(this.options.touchStartThreshold=1),n.supportPointer?f(e,"pointerdown",this._onTapStart):(f(e,"mousedown",this._onTapStart),f(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(f(e,"dragover",this),f(e,"dragenter",this)),ke.push(this.el),n.store&&n.store.get&&this.sort(n.store.get(this)||[]),o(this,(r=[],{captureAnimationState:function(){r=[],this.options.animation&&[].slice.call(this.el.children).forEach(function(e){if("none"!==E(e,"display")&&e!==Be.ghost){r.push({target:e,rect:_(e)});var n=t({},r[r.length-1].rect);if(e.thisAnimationDuration){var i=S(e,!0);i&&(n.top-=i.f,n.left-=i.e)}e.fromRect=n}})},addAnimationState:function(e){r.push(e)},removeAnimationState:function(e){r.splice(function(e,t){for(var n in e)if(e.hasOwnProperty(n))for(var i in t)if(t.hasOwnProperty(i)&&t[i]===e[n][i])return Number(n);return-1}(r,{target:e}),1)},animateAll:function(e){var t=this;if(!this.options.animation)return clearTimeout(i),void("function"==typeof e&&e());var n=!1,o=0;r.forEach(function(e){var i=0,r=e.target,a=r.fromRect,l=_(r),s=r.prevFromRect,c=r.prevToRect,d=e.rect,u=S(r,!0);u&&(l.top-=u.f,l.left-=u.e),r.toRect=l,r.thisAnimationDuration&&N(s,l)&&!N(a,l)&&(d.top-l.top)/(d.left-l.left)===(a.top-l.top)/(a.left-l.left)&&(i=function(e,t,n,i){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*i.animation}(d,s,c,t.options)),N(l,a)||(r.prevFromRect=a,r.prevToRect=l,i||(i=t.options.animation),t.animate(r,d,l,i)),i&&(n=!0,o=Math.max(o,i),clearTimeout(r.animationResetTimer),r.animationResetTimer=setTimeout(function(){r.animationTime=0,r.prevFromRect=null,r.fromRect=null,r.prevToRect=null,r.thisAnimationDuration=null},i),r.thisAnimationDuration=i)}),clearTimeout(i),n?i=setTimeout(function(){"function"==typeof e&&e()},o):"function"==typeof e&&e(),r=[]},animate:function(e,t,n,i){if(i){E(e,"transition",""),E(e,"transform","");var o=S(this.el),r=o&&o.a,a=o&&o.d,l=(t.left-n.left)/(r||1),s=(t.top-n.top)/(a||1);e.animatingX=!!l,e.animatingY=!!s,E(e,"transform","translate3d("+l+"px,"+s+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),E(e,"transition","transform "+i+"ms"+(this.options.easing?" "+this.options.easing:"")),E(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout(function(){E(e,"transition",""),E(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1},i)}}}))}function je(e,t,n,i,o,r,a,c){var d,u,h=e[W],p=h.options.onMove;return!window.CustomEvent||l||s?(d=document.createEvent("Event")).initEvent("move",!0,!0):d=new CustomEvent("move",{bubbles:!0,cancelable:!0}),d.to=t,d.from=e,d.dragged=n,d.draggedRect=i,d.related=o||t,d.relatedRect=r||_(t),d.willInsertAfter=c,d.originalEvent=a,e.dispatchEvent(d),p&&(u=p.call(h,d,a)),u}function We(e){e.draggable=!1}function Fe(){De=!1}function Re(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,i=0;n--;)i+=t.charCodeAt(n);return i.toString(36)}function Ye(e){return setTimeout(e,0)}function Xe(e){return clearTimeout(e)}Be.prototype={constructor:Be,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(ge=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,z):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,n=this.el,i=this.options,o=i.preventOnFilter,r=e.type,a=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,l=(a||e).target,s=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,c=i.filter;if(function(e){_e.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var i=t[n];i.checked&&_e.push(i)}}(n),!z&&!(/mousedown|pointerdown/.test(r)&&0!==e.button||i.disabled)&&!s.isContentEditable&&(this.nativeDraggable||!d||!l||"SELECT"!==l.tagName.toUpperCase())&&!((l=b(l,i.draggable,n,!1))&&l.animated||Q===l)){if(ne=I(l),oe=I(l,i.draggable),"function"==typeof c){if(c.call(this,e,l,this))return K({sortable:t,rootEl:s,name:"filter",targetEl:l,toEl:n,fromEl:n}),H("filter",t,{evt:e}),void(o&&e.cancelable&&e.preventDefault())}else if(c&&(c=c.split(",").some(function(i){if(i=b(s,i.trim(),n,!1))return K({sortable:t,rootEl:i,name:"filter",targetEl:l,fromEl:n,toEl:n}),H("filter",t,{evt:e}),!0})))return void(o&&e.cancelable&&e.preventDefault());i.handle&&!b(s,i.handle,n,!1)||this._prepareDragStart(e,a,l)}}},_prepareDragStart:function(e,t,n){var i,o=this,r=o.el,a=o.options,d=r.ownerDocument;if(n&&!z&&n.parentNode===r){var u=_(n);if(Z=r,G=(z=n).parentNode,J=z.nextSibling,Q=n,ae=a.group,Be.dragged=z,se={target:z,clientX:(t||e).clientX,clientY:(t||e).clientY},he=se.clientX-u.left,pe=se.clientY-u.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,z.style["will-change"]="all",i=function(){H("delayEnded",o,{evt:e}),Be.eventCanceled?o._onDrop():(o._disableDelayedDragEvents(),!c&&o.nativeDraggable&&(z.draggable=!0),o._triggerDragStart(e,t),K({sortable:o,name:"choose",originalEvent:e}),k(z,a.chosenClass,!0))},a.ignore.split(",").forEach(function(e){C(z,e.trim(),We)}),f(d,"dragover",$e),f(d,"mousemove",$e),f(d,"touchmove",$e),f(d,"mouseup",o._onDrop),f(d,"touchend",o._onDrop),f(d,"touchcancel",o._onDrop),c&&this.nativeDraggable&&(this.options.touchStartThreshold=4,z.draggable=!0),H("delayStart",this,{evt:e}),!a.delay||a.delayOnTouchOnly&&!t||this.nativeDraggable&&(s||l))i();else{if(Be.eventCanceled)return void this._onDrop();f(d,"mouseup",o._disableDelayedDrag),f(d,"touchend",o._disableDelayedDrag),f(d,"touchcancel",o._disableDelayedDrag),f(d,"mousemove",o._delayedDragTouchMoveHandler),f(d,"touchmove",o._delayedDragTouchMoveHandler),a.supportPointer&&f(d,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(i,a.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){z&&We(z),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;g(e,"mouseup",this._disableDelayedDrag),g(e,"touchend",this._disableDelayedDrag),g(e,"touchcancel",this._disableDelayedDrag),g(e,"mousemove",this._delayedDragTouchMoveHandler),g(e,"touchmove",this._delayedDragTouchMoveHandler),g(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?f(document,"pointermove",this._onTouchMove):f(document,t?"touchmove":"mousemove",this._onTouchMove):(f(z,"dragend",this),f(Z,"dragstart",this._onDragStart));try{document.selection?Ye(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){if(ye=!1,Z&&z){H("dragStarted",this,{evt:t}),this.nativeDraggable&&f(document,"dragover",Le);var n=this.options;!e&&k(z,n.dragClass,!1),k(z,n.ghostClass,!0),Be.active=this,e&&this._appendGhost(),K({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(ce){this._lastX=ce.clientX,this._lastY=ce.clientY,qe();for(var e=document.elementFromPoint(ce.clientX,ce.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(ce.clientX,ce.clientY))!==t;)t=e;if(z.parentNode[W]._isOutsideThisEl(e),t)do{if(t[W]&&t[W]._onDragOver({clientX:ce.clientX,clientY:ce.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break;e=t}while(t=t.parentNode);Pe()}},_onTouchMove:function(e){if(se){var t=this.options,n=t.fallbackTolerance,i=t.fallbackOffset,o=e.touches?e.touches[0]:e,r=U&&S(U,!0),a=U&&r&&r.a,l=U&&r&&r.d,s=Ae&&be&&O(be),c=(o.clientX-se.clientX+i.x)/(a||1)+(s?s[0]-Ce[0]:0)/(a||1),d=(o.clientY-se.clientY+i.y)/(l||1)+(s?s[1]-Ce[1]:0)/(l||1);if(!Be.active&&!ye){if(n&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(U){r?(r.e+=c-(de||0),r.f+=d-(ue||0)):r={a:1,b:0,c:0,d:1,e:c,f:d};var u="matrix(".concat(r.a,",").concat(r.b,",").concat(r.c,",").concat(r.d,",").concat(r.e,",").concat(r.f,")");E(U,"webkitTransform",u),E(U,"mozTransform",u),E(U,"msTransform",u),E(U,"transform",u),de=c,ue=d,ce=o}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!U){var e=this.options.fallbackOnBody?document.body:Z,t=_(z,!0,Ae,!0,e),n=this.options;if(Ae){for(be=e;"static"===E(be,"position")&&"none"===E(be,"transform")&&be!==document;)be=be.parentNode;be!==document.body&&be!==document.documentElement?(be===document&&(be=D()),t.top+=be.scrollTop,t.left+=be.scrollLeft):be=D(),Ce=O(be)}k(U=z.cloneNode(!0),n.ghostClass,!1),k(U,n.fallbackClass,!0),k(U,n.dragClass,!0),E(U,"transition",""),E(U,"transform",""),E(U,"box-sizing","border-box"),E(U,"margin",0),E(U,"top",t.top),E(U,"left",t.left),E(U,"width",t.width),E(U,"height",t.height),E(U,"opacity","0.8"),E(U,"position",Ae?"absolute":"fixed"),E(U,"zIndex","100000"),E(U,"pointerEvents","none"),Be.ghost=U,e.appendChild(U),E(U,"transform-origin",he/parseInt(U.style.width)*100+"% "+pe/parseInt(U.style.height)*100+"%")}},_onDragStart:function(e,t){var n=this,i=e.dataTransfer,o=n.options;H("dragStart",this,{evt:e}),Be.eventCanceled?this._onDrop():(H("setupClone",this),Be.eventCanceled||((ee=$(z)).removeAttribute("id"),ee.draggable=!1,ee.style["will-change"]="",this._hideClone(),k(ee,this.options.chosenClass,!1),Be.clone=ee),n.cloneId=Ye(function(){H("clone",n),Be.eventCanceled||(n.options.removeCloneOnHide||Z.insertBefore(ee,z),n._hideClone(),K({sortable:n,name:"clone"}))}),!t&&k(z,o.dragClass,!0),t?(we=!0,n._loopId=setInterval(n._emulateDragOver,50)):(g(document,"mouseup",n._onDrop),g(document,"touchend",n._onDrop),g(document,"touchcancel",n._onDrop),i&&(i.effectAllowed="move",o.setData&&o.setData.call(n,i,z)),f(document,"drop",n),E(z,"transform","translateZ(0)")),ye=!0,n._dragStartId=Ye(n._dragStarted.bind(n,t,e)),f(document,"selectstart",n),fe=!0,d&&E(document.body,"user-select","none"))},_onDragOver:function(e){var n,i,o,r,a=this.el,l=e.target,s=this.options,c=s.group,d=Be.active,u=ae===c,h=s.sort,p=le||d,f=this,g=!1;if(!De){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),l=b(l,s.draggable,a,!0),F("dragOver"),Be.eventCanceled)return g;if(z.contains(e.target)||l.animated&&l.animatingX&&l.animatingY||f._ignoreWhileAnimating===l)return Y(!1);if(we=!1,d&&!s.disabled&&(u?h||(o=G!==Z):le===this||(this.lastPutMode=ae.checkPull(this,d,z,e))&&c.checkPut(this,d,z,e))){if(r="vertical"===this._getDirection(e,l),n=_(z),F("dragOverValid"),Be.eventCanceled)return g;if(o)return G=Z,R(),this._hideClone(),F("revert"),Be.eventCanceled||(J?Z.insertBefore(z,J):Z.appendChild(z)),Y(!0);var m=T(a,s.draggable);if(!m||function(e,t,n){var i=_(T(n.el,n.options.draggable)),o=j(n.el,n.options,U);return t?e.clientX>o.right+10||e.clientY>i.bottom&&e.clientX>i.left:e.clientY>o.bottom+10||e.clientX>i.right&&e.clientY>i.top}(e,r,this)&&!m.animated){if(m===z)return Y(!1);if(m&&a===e.target&&(l=m),l&&(i=_(l)),!1!==je(Z,a,z,n,l,i,e,!!l))return R(),m&&m.nextSibling?a.insertBefore(z,m.nextSibling):a.appendChild(z),G=a,X(),Y(!0)}else if(m&&function(e,t,n){var i=_(A(n.el,0,n.options,!0)),o=j(n.el,n.options,U);return t?e.clientX<o.left-10||e.clientY<i.top&&e.clientX<i.right:e.clientY<o.top-10||e.clientY<i.bottom&&e.clientX<i.left}(e,r,this)){var v=A(a,0,s,!0);if(v===z)return Y(!1);if(i=_(l=v),!1!==je(Z,a,z,n,l,i,e,!1))return R(),a.insertBefore(z,v),G=a,X(),Y(!0)}else if(l.parentNode===a){i=_(l);var y,w,S,C=z.parentNode!==a,D=!function(e,t,n){var i=n?e.left:e.top,o=n?e.right:e.bottom,r=n?e.width:e.height,a=n?t.left:t.top,l=n?t.right:t.bottom,s=n?t.width:t.height;return i===a||o===l||i+r/2===a+s/2}(z.animated&&z.toRect||n,l.animated&&l.toRect||i,r),O=r?"top":"left",M=x(l,"top","top")||x(z,"top","top"),N=M?M.scrollTop:void 0;if(ge!==l&&(w=i[O],Ee=!1,Se=!D&&s.invertSwap||C),y=function(e,t,n,i,o,r,a,l){var s=i?e.clientY:e.clientX,c=i?n.height:n.width,d=i?n.top:n.left,u=i?n.bottom:n.right,h=!1;if(!a)if(l&&ve<c*o){if(!Ee&&(1===me?s>d+c*r/2:s<u-c*r/2)&&(Ee=!0),Ee)h=!0;else if(1===me?s<d+ve:s>u-ve)return-me}else if(s>d+c*(1-o)/2&&s<u-c*(1-o)/2)return function(e){return I(z)<I(e)?1:-1}(t);return(h=h||a)&&(s<d+c*r/2||s>u-c*r/2)?s>d+c/2?1:-1:0}(e,l,i,r,D?1:s.swapThreshold,null==s.invertedSwapThreshold?s.swapThreshold:s.invertedSwapThreshold,Se,ge===l),0!==y){var q=I(z);do{q-=y,S=G.children[q]}while(S&&("none"===E(S,"display")||S===U))}if(0===y||S===l)return Y(!1);ge=l,me=y;var $=l.nextElementSibling,L=!1,B=je(Z,a,z,n,l,i,e,L=1===y);if(!1!==B)return 1!==B&&-1!==B||(L=1===B),De=!0,setTimeout(Fe,30),R(),L&&!$?a.appendChild(z):l.parentNode.insertBefore(z,L?$:l),M&&P(M,0,N-M.scrollTop),G=z.parentNode,void 0===w||Se||(ve=Math.abs(w-_(l)[O])),X(),Y(!0)}if(a.contains(z))return Y(!1)}return!1}function F(s,c){H(s,f,t({evt:e,isOwner:u,axis:r?"vertical":"horizontal",revert:o,dragRect:n,targetRect:i,canSort:h,fromSortable:p,target:l,completed:Y,onMove:function(t,i){return je(Z,a,z,n,t,_(t),e,i)},changed:X},c))}function R(){F("dragOverAnimationCapture"),f.captureAnimationState(),f!==p&&p.captureAnimationState()}function Y(t){return F("dragOverCompleted",{insertion:t}),t&&(u?d._hideClone():d._showClone(f),f!==p&&(k(z,le?le.options.ghostClass:d.options.ghostClass,!1),k(z,s.ghostClass,!0)),le!==f&&f!==Be.active?le=f:f===Be.active&&le&&(le=null),p===f&&(f._ignoreWhileAnimating=l),f.animateAll(function(){F("dragOverAnimationComplete"),f._ignoreWhileAnimating=null}),f!==p&&(p.animateAll(),p._ignoreWhileAnimating=null)),(l===z&&!z.animated||l===a&&!l.animated)&&(ge=null),s.dragoverBubble||e.rootEl||l===document||(z.parentNode[W]._isOutsideThisEl(e.target),!t&&$e(e)),!s.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),g=!0}function X(){ie=I(z),re=I(z,s.draggable),K({sortable:f,name:"change",toEl:a,newIndex:ie,newDraggableIndex:re,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){g(document,"mousemove",this._onTouchMove),g(document,"touchmove",this._onTouchMove),g(document,"pointermove",this._onTouchMove),g(document,"dragover",$e),g(document,"mousemove",$e),g(document,"touchmove",$e)},_offUpEvents:function(){var e=this.el.ownerDocument;g(e,"mouseup",this._onDrop),g(e,"touchend",this._onDrop),g(e,"pointerup",this._onDrop),g(e,"touchcancel",this._onDrop),g(document,"selectstart",this)},_onDrop:function(e){var t=this.el,n=this.options;ie=I(z),re=I(z,n.draggable),H("drop",this,{evt:e}),G=z&&z.parentNode,ie=I(z),re=I(z,n.draggable),Be.eventCanceled||(ye=!1,Se=!1,Ee=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Xe(this.cloneId),Xe(this._dragStartId),this.nativeDraggable&&(g(document,"drop",this),g(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),d&&E(document.body,"user-select",""),E(z,"transform",""),e&&(fe&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),U&&U.parentNode&&U.parentNode.removeChild(U),(Z===G||le&&"clone"!==le.lastPutMode)&&ee&&ee.parentNode&&ee.parentNode.removeChild(ee),z&&(this.nativeDraggable&&g(z,"dragend",this),We(z),z.style["will-change"]="",fe&&!ye&&k(z,le?le.options.ghostClass:this.options.ghostClass,!1),k(z,this.options.chosenClass,!1),K({sortable:this,name:"unchoose",toEl:G,newIndex:null,newDraggableIndex:null,originalEvent:e}),Z!==G?(ie>=0&&(K({rootEl:G,name:"add",toEl:G,fromEl:Z,originalEvent:e}),K({sortable:this,name:"remove",toEl:G,originalEvent:e}),K({rootEl:G,name:"sort",toEl:G,fromEl:Z,originalEvent:e}),K({sortable:this,name:"sort",toEl:G,originalEvent:e})),le&&le.save()):ie!==ne&&ie>=0&&(K({sortable:this,name:"update",toEl:G,originalEvent:e}),K({sortable:this,name:"sort",toEl:G,originalEvent:e})),Be.active&&(null!=ie&&-1!==ie||(ie=ne,re=oe),K({sortable:this,name:"end",toEl:G,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){H("nulling",this),Z=z=G=U=J=ee=Q=te=se=ce=fe=ie=re=ne=oe=ge=me=le=ae=Be.dragged=Be.ghost=Be.clone=Be.active=null,_e.forEach(function(e){e.checked=!0}),_e.length=de=ue=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":z&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],n=this.el.children,i=0,o=n.length,r=this.options;i<o;i++)b(e=n[i],r.draggable,this.el,!1)&&t.push(e.getAttribute(r.dataIdAttr)||Re(e));return t},sort:function(e,t){var n={},i=this.el;this.toArray().forEach(function(e,t){var o=i.children[t];b(o,this.options.draggable,i,!1)&&(n[e]=o)},this),t&&this.captureAnimationState(),e.forEach(function(e){n[e]&&(i.removeChild(n[e]),i.appendChild(n[e]))}),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return b(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(void 0===t)return n[e];var i=Y.modifyOption(this,e,t);n[e]=void 0!==i?i:t,"group"===e&&Ne(n)},destroy:function(){H("destroy",this);var e=this.el;e[W]=null,g(e,"mousedown",this._onTapStart),g(e,"touchstart",this._onTapStart),g(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(g(e,"dragover",this),g(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),ke.splice(ke.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!te){if(H("hideClone",this),Be.eventCanceled)return;E(ee,"display","none"),this.options.removeCloneOnHide&&ee.parentNode&&ee.parentNode.removeChild(ee),te=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(te){if(H("showClone",this),Be.eventCanceled)return;z.parentNode!=Z||this.options.group.revertClone?J?Z.insertBefore(ee,J):Z.appendChild(ee):Z.insertBefore(ee,z),this.options.group.revertClone&&this.animate(z,ee),E(ee,"display",""),te=!1}}else this._hideClone()}},xe&&f(document,"touchmove",function(e){(Be.active||ye)&&e.cancelable&&e.preventDefault()}),Be.utils={on:f,off:g,css:E,find:C,is:function(e,t){return!!b(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},throttle:q,closest:b,toggleClass:k,clone:$,index:I,nextTick:Ye,cancelNextTick:Xe,detectDirection:Me,getChild:A},Be.get=function(e){return e[W]},Be.mount=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n[0].constructor===Array&&(n=n[0]),n.forEach(function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(Be.utils=t(t({},Be.utils),e.utils)),Y.mount(e)})},Be.create=function(e,t){return new Be(e,t)},Be.version="1.15.2";var Ve,He,Ke,ze,Ge,Ue,Ze=[],Je=!1;function Qe(){Ze.forEach(function(e){clearInterval(e.pid)}),Ze=[]}function et(){clearInterval(Ue)}var tt=q(function(e,t,n,i){if(t.scroll){var o,r=(e.touches?e.touches[0]:e).clientX,a=(e.touches?e.touches[0]:e).clientY,l=t.scrollSensitivity,s=t.scrollSpeed,c=D(),d=!1;He!==n&&(He=n,Qe(),Ve=t.scroll,o=t.scrollFn,!0===Ve&&(Ve=M(n,!0)));var u=0,h=Ve;do{var p=h,f=_(p),g=f.top,m=f.bottom,v=f.left,b=f.right,y=f.width,w=f.height,k=void 0,S=void 0,C=p.scrollWidth,x=p.scrollHeight,A=E(p),T=p.scrollLeft,I=p.scrollTop;p===c?(k=y<C&&("auto"===A.overflowX||"scroll"===A.overflowX||"visible"===A.overflowX),S=w<x&&("auto"===A.overflowY||"scroll"===A.overflowY||"visible"===A.overflowY)):(k=y<C&&("auto"===A.overflowX||"scroll"===A.overflowX),S=w<x&&("auto"===A.overflowY||"scroll"===A.overflowY));var O=k&&(Math.abs(b-r)<=l&&T+y<C)-(Math.abs(v-r)<=l&&!!T),N=S&&(Math.abs(m-a)<=l&&I+w<x)-(Math.abs(g-a)<=l&&!!I);if(!Ze[u])for(var q=0;q<=u;q++)Ze[q]||(Ze[q]={});Ze[u].vx==O&&Ze[u].vy==N&&Ze[u].el===p||(Ze[u].el=p,Ze[u].vx=O,Ze[u].vy=N,clearInterval(Ze[u].pid),0==O&&0==N||(d=!0,Ze[u].pid=setInterval(function(){i&&0===this.layer&&Be.active._onTouchMove(Ge);var t=Ze[this.layer].vy?Ze[this.layer].vy*s:0,n=Ze[this.layer].vx?Ze[this.layer].vx*s:0;"function"==typeof o&&"continue"!==o.call(Be.dragged.parentNode[W],n,t,e,Ge,Ze[this.layer].el)||P(Ze[this.layer].el,n,t)}.bind({layer:u}),24))),u++}while(t.bubbleScroll&&h!==c&&(h=M(h,!1)));Je=d}},30),nt=function(e){var t=e.originalEvent,n=e.putSortable,i=e.dragEl,o=e.activeSortable,r=e.dispatchSortableEvent,a=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(t){var s=n||o;a();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,d=document.elementFromPoint(c.clientX,c.clientY);l(),s&&!s.el.contains(d)&&(r("spill"),this.onSpill({dragEl:i,putSortable:n}))}};function it(){}function ot(){}it.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var i=A(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(t,i):this.sortable.el.appendChild(t),this.sortable.animateAll(),n&&n.animateAll()},drop:nt},o(it,{pluginName:"revertOnSpill"}),ot.prototype={onSpill:function(e){var t=e.dragEl,n=e.putSortable||this.sortable;n.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),n.animateAll()},drop:nt},o(ot,{pluginName:"removeOnSpill"});var rt,at,lt,st,ct,dt=[],ut=[],ht=!1,pt=!1,ft=!1;function gt(e,t){ut.forEach(function(n,i){var o=t.children[n.sortableIndex+(e?Number(i):0)];o?t.insertBefore(n,o):t.appendChild(n)})}function mt(){dt.forEach(function(e){e!==lt&&e.parentNode&&e.parentNode.removeChild(e)})}Be.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?f(document,"dragover",this._handleAutoScroll):this.options.supportPointer?f(document,"pointermove",this._handleFallbackAutoScroll):t.touches?f(document,"touchmove",this._handleFallbackAutoScroll):f(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?g(document,"dragover",this._handleAutoScroll):(g(document,"pointermove",this._handleFallbackAutoScroll),g(document,"touchmove",this._handleFallbackAutoScroll),g(document,"mousemove",this._handleFallbackAutoScroll)),et(),Qe(),clearTimeout(y),y=void 0},nulling:function(){Ge=He=Ve=Je=Ue=Ke=ze=null,Ze.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var n=this,i=(e.touches?e.touches[0]:e).clientX,o=(e.touches?e.touches[0]:e).clientY,r=document.elementFromPoint(i,o);if(Ge=e,t||this.options.forceAutoScrollFallback||s||l||d){tt(e,this.options,r,t);var a=M(r,!0);!Je||Ue&&i===Ke&&o===ze||(Ue&&et(),Ue=setInterval(function(){var r=M(document.elementFromPoint(i,o),!0);r!==a&&(a=r,Qe()),tt(e,n.options,r,t)},10),Ke=i,ze=o)}else{if(!this.options.bubbleScroll||M(r,!0)===D())return void Qe();tt(e,this.options,M(r,!1),!1)}}},o(e,{pluginName:"scroll",initializeByDefault:!0})}),Be.mount(ot,it);const vt=Be;vt.mount(new function(){function e(e){for(var t in this)"_"===t.charAt(0)&&"function"==typeof this[t]&&(this[t]=this[t].bind(this));e.options.avoidImplicitDeselect||(e.options.supportPointer?f(document,"pointerup",this._deselectMultiDrag):(f(document,"mouseup",this._deselectMultiDrag),f(document,"touchend",this._deselectMultiDrag))),f(document,"keydown",this._checkKeyDown),f(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,avoidImplicitDeselect:!1,setData:function(t,n){var i="";dt.length&&at===e?dt.forEach(function(e,t){i+=(t?", ":"")+e.textContent}):i=n.textContent,t.setData("Text",i)}}}return e.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(e){var t=e.dragEl;lt=t},delayEnded:function(){this.isMultiDrag=~dt.indexOf(lt)},setupClone:function(e){var t=e.sortable,n=e.cancel;if(this.isMultiDrag){for(var i=0;i<dt.length;i++)ut.push($(dt[i])),ut[i].sortableIndex=dt[i].sortableIndex,ut[i].draggable=!1,ut[i].style["will-change"]="",k(ut[i],this.options.selectedClass,!1),dt[i]===lt&&k(ut[i],this.options.chosenClass,!1);t._hideClone(),n()}},clone:function(e){var t=e.sortable,n=e.rootEl,i=e.dispatchSortableEvent,o=e.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||dt.length&&at===t&&(gt(!0,n),i("clone"),o()))},showClone:function(e){var t=e.cloneNowShown,n=e.rootEl,i=e.cancel;this.isMultiDrag&&(gt(!1,n),ut.forEach(function(e){E(e,"display","")}),t(),ct=!1,i())},hideClone:function(e){var t=this,n=(e.sortable,e.cloneNowHidden),i=e.cancel;this.isMultiDrag&&(ut.forEach(function(e){E(e,"display","none"),t.options.removeCloneOnHide&&e.parentNode&&e.parentNode.removeChild(e)}),n(),ct=!0,i())},dragStartGlobal:function(e){e.sortable,!this.isMultiDrag&&at&&at.multiDrag._deselectMultiDrag(),dt.forEach(function(e){e.sortableIndex=I(e)}),dt=dt.sort(function(e,t){return e.sortableIndex-t.sortableIndex}),ft=!0},dragStarted:function(e){var t=this,n=e.sortable;if(this.isMultiDrag){if(this.options.sort&&(n.captureAnimationState(),this.options.animation)){dt.forEach(function(e){e!==lt&&E(e,"position","absolute")});var i=_(lt,!1,!0,!0);dt.forEach(function(e){e!==lt&&L(e,i)}),pt=!0,ht=!0}n.animateAll(function(){pt=!1,ht=!1,t.options.animation&&dt.forEach(function(e){B(e)}),t.options.sort&&mt()})}},dragOver:function(e){var t=e.target,n=e.completed,i=e.cancel;pt&&~dt.indexOf(t)&&(n(!1),i())},revert:function(e){var t=e.fromSortable,n=e.rootEl,i=e.sortable,o=e.dragRect;dt.length>1&&(dt.forEach(function(e){i.addAnimationState({target:e,rect:pt?_(e):o}),B(e),e.fromRect=o,t.removeAnimationState(e)}),pt=!1,function(e,t){dt.forEach(function(n,i){var o=t.children[n.sortableIndex+(e?Number(i):0)];o?t.insertBefore(n,o):t.appendChild(n)})}(!this.options.removeCloneOnHide,n))},dragOverCompleted:function(e){var t=e.sortable,n=e.isOwner,i=e.insertion,o=e.activeSortable,r=e.parentEl,a=e.putSortable,l=this.options;if(i){if(n&&o._hideClone(),ht=!1,l.animation&&dt.length>1&&(pt||!n&&!o.options.sort&&!a)){var s=_(lt,!1,!0,!0);dt.forEach(function(e){e!==lt&&(L(e,s),r.appendChild(e))}),pt=!0}if(!n)if(pt||mt(),dt.length>1){var c=ct;o._showClone(t),o.options.animation&&!ct&&c&&ut.forEach(function(e){o.addAnimationState({target:e,rect:st}),e.fromRect=st,e.thisAnimationDuration=null})}else o._showClone(t)}},dragOverAnimationCapture:function(e){var t=e.dragRect,n=e.isOwner,i=e.activeSortable;if(dt.forEach(function(e){e.thisAnimationDuration=null}),i.options.animation&&!n&&i.multiDrag.isMultiDrag){st=o({},t);var r=S(lt,!0);st.top-=r.f,st.left-=r.e}},dragOverAnimationComplete:function(){pt&&(pt=!1,mt())},drop:function(e){var t=e.originalEvent,n=e.rootEl,i=e.parentEl,o=e.sortable,r=e.dispatchSortableEvent,a=e.oldIndex,l=e.putSortable,s=l||this.sortable;if(t){var c=this.options,d=i.children;if(!ft)if(c.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),k(lt,c.selectedClass,!~dt.indexOf(lt)),~dt.indexOf(lt))dt.splice(dt.indexOf(lt),1),rt=null,X({sortable:o,rootEl:n,name:"deselect",targetEl:lt,originalEvent:t});else{if(dt.push(lt),X({sortable:o,rootEl:n,name:"select",targetEl:lt,originalEvent:t}),t.shiftKey&&rt&&o.el.contains(rt)){var u,h,p=I(rt),f=I(lt);if(~p&&~f&&p!==f)for(f>p?(h=p,u=f):(h=f,u=p+1);h<u;h++)~dt.indexOf(d[h])||(k(d[h],c.selectedClass,!0),dt.push(d[h]),X({sortable:o,rootEl:n,name:"select",targetEl:d[h],originalEvent:t}))}else rt=lt;at=s}if(ft&&this.isMultiDrag){if(pt=!1,(i[W].options.sort||i!==n)&&dt.length>1){var g=_(lt),m=I(lt,":not(."+this.options.selectedClass+")");if(!ht&&c.animation&&(lt.thisAnimationDuration=null),s.captureAnimationState(),!ht&&(c.animation&&(lt.fromRect=g,dt.forEach(function(e){if(e.thisAnimationDuration=null,e!==lt){var t=pt?_(e):g;e.fromRect=t,s.addAnimationState({target:e,rect:t})}})),mt(),dt.forEach(function(e){d[m]?i.insertBefore(e,d[m]):i.appendChild(e),m++}),a===I(lt))){var v=!1;dt.forEach(function(e){e.sortableIndex===I(e)||(v=!0)}),v&&(r("update"),r("sort"))}dt.forEach(function(e){B(e)}),s.animateAll()}at=s}(n===i||l&&"clone"!==l.lastPutMode)&&ut.forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)})}},nullingGlobal:function(){this.isMultiDrag=ft=!1,ut.length=0},destroyGlobal:function(){this._deselectMultiDrag(),g(document,"pointerup",this._deselectMultiDrag),g(document,"mouseup",this._deselectMultiDrag),g(document,"touchend",this._deselectMultiDrag),g(document,"keydown",this._checkKeyDown),g(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(e){if(!(void 0!==ft&&ft||at!==this.sortable||e&&b(e.target,this.options.draggable,this.sortable.el,!1)||e&&0!==e.button))for(;dt.length;){var t=dt[0];k(t,this.options.selectedClass,!1),dt.shift(),X({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:t,originalEvent:e})}},_checkKeyDown:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},o(e,{pluginName:"multiDrag",utils:{select:function(e){var t=e.parentNode[W];t&&t.options.multiDrag&&!~dt.indexOf(e)&&(at&&at!==t&&(at.multiDrag._deselectMultiDrag(),at=t),k(e,t.options.selectedClass,!0),dt.push(e))},deselect:function(e){var t=e.parentNode[W],n=dt.indexOf(e);t&&t.options.multiDrag&&~n&&(k(e,t.options.selectedClass,!1),dt.splice(n,1))}},eventProperties:function(){var e,t=this,n=[],i=[];return dt.forEach(function(e){var o;n.push({multiDragElement:e,index:e.sortableIndex}),o=pt&&e!==lt?-1:pt?I(e,":not(."+t.options.selectedClass+")"):I(e),i.push({multiDragElement:e,index:o})}),{items:(e=dt,function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),clones:[].concat(ut),oldIndicies:n,newIndicies:i}},optionListeners:{multiDragKey:function(e){return"ctrl"===(e=e.toLowerCase())?e="Control":e.length>1&&(e=e.charAt(0).toUpperCase()+e.substr(1)),e}}})});class bt extends window.StimulusController{get sortableConfig(){return{multiDrag:!0,selectedClass:"sort-selected",handle:this.handleValue,animation:150,swapThreshold:1,draggable:this.draggableValue,onEnd:e=>{this.reOrderItems()}}}connect(){this.hasItemsTarget?this.sortable=vt.create(this.itemsTarget,this.sortableConfig):console.error("SortableController: No items target found")}itemsTargetConnected(e){"connected"!==e.dataset.sortable&&(this.sortable&&this.sortable.destroy(),e.dataset.sortable="connected",this.sortable=vt.create(e,this.sortableConfig))}itemTargetConnected(e){this.reOrderItems()}replaceValues(){return this.replaceValue.split(";")}reOrderItems(){for(var e=this.replaceValues(),t=this.itemTargets.filter(e=>"none"!==e.style.display),n=0;n<t.length;n++){var i=t[n],o=i.dataset.replace;o&&(e=o.split(";"));for(var r=0;r<e.length;r++){var a=e[r];let t=n;if(a.endsWith("+")&&(a=a.slice(0,-1),t=n+1),a.startsWith("[")&&a.endsWith("]"))if((a=a.slice(1,-1)).startsWith("data-")){var l=a.slice(5);i.dataset[l]=t.toString()}else i.setAttribute(a,t.toString());else{var s=i.querySelector(a);s?s instanceof HTMLInputElement?s.value=t.toString():s.textContent=t.toString():console.error("Could not find element with selector",a)}}}}}bt.targets=["item","items"],bt.values={replace:String,handle:{type:String,default:".sequence-block-field-drag-handle"},draggable:{type:String,default:".sequence-block-field"}};class yt extends window.StimulusController{static registerClass(e,t){this.classRegistry[t]=e}get classArgs(){return this.hasClassArgsValue?(this._classArgs||(this._classArgs=JSON.parse(this.classArgsValue)),this._classArgs):{}}connect(){const e=this.constructor;if(this.classPathValue in e.classRegistry){const t=e.classRegistry[this.classPathValue],n=this.initializeClass(t),i=this.element;i[`${this.identifier}Class`]=n,i[`${this.identifier}Controller`]=this}else console.error(`Class ${this.classPathValue} not found in registered classes`)}initializeClass(e){return new e(this.classArgs)}}yt.classRegistry={},yt.values={classPath:String,classArgs:String};class wt extends yt{constructor(...e){return super(...e),new Proxy(this,{get:(e,t,n)=>{const i=Reflect.get(e,t,n);if(void 0!==i)return i;if("string"==typeof t&&t.startsWith("block")){const n=t.slice(5),i=n.charAt(0).toLowerCase()+n.slice(1);return(...t)=>{const n=e.element.blocks,o=n.bound[i];if("function"==typeof o)return o.apply(n.bound,t);console.warn(`[BlockController] No block method '${i}' found on`,n.bound)}}return i}})}initializeClass(e){if(this.element.classList.contains("block-initiated"))return null;this.element.classList.add("block-initiated");const t=window.telepath.unpack(this.classArgs),n=t.render(this.element,this.idValue,...this.argumentsValue);return this.element.blocks={block:t,bound:n},n}}wt.values=Object.assign(Object.assign({},yt.values),{id:String,arguments:Array});class kt{constructor(e,t,n){this.block=e,this.name=t,this.element=n}getLabel(){throw new Error("Method not implemented.")}getState(){throw new Error("Method not implemented.")}getError(){throw new Error("Method not implemented.")}setState(e){throw new Error("Method not implemented.")}setError(e){throw new Error("Method not implemented.")}}class Et{render(e,t,...n){throw new Error("Method not implemented.")}}const St=new Set(["svg","path","circle","rect","g","defs","clipPath","use","line","polygon","polyline","ellipse","text","tspan","marker","pattern","mask","symbol","view"]);function Ct(e,t,...n){if("function"==typeof e)return e(null!=t?t:{},n);const i=St.has(e),o=i?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);if(t)for(const[e,n]of Object.entries(t))if("class"===e)o.setAttribute("class",n);else if("style"===e&&"object"==typeof n)Object.assign(o.style,n);else if(e.startsWith("on")&&"function"==typeof n){const t=e.slice(2).toLowerCase();o.addEventListener(t,n)}else i?o.setAttribute(e,n):e in o?o[e]=n:o.setAttribute(e,n);const r=e=>{null!=e&&!1!==e&&!0!==e&&("string"==typeof e?o.appendChild(document.createTextNode(e)):e instanceof Node?o.appendChild(e):Array.isArray(e)?e.forEach(r):console.warn("Invalid child type:",e))};return n.forEach(r),o}function Dt(e,t={}){const n="http://www.w3.org/2000/svg",i=document.createElementNS(n,"svg");i.setAttribute("class",`icon ${e}`);const o=document.createElementNS(n,"use");o.setAttributeNS("http://www.w3.org/1999/xlink","href",`#${e}`),i.appendChild(o);for(const n in t)"class"==n?i.setAttribute(n,`icon ${e} ${t[n]}`):i.setAttribute(n,t[n]);return i}function _t(...e){return Ct("div",{class:"panel__body","data-panel-target":"content"},e)}function xt(e){return null==e||"string"==typeof e&&""===e.trim()||!(!Array.isArray(e)||0!==e.length)}function At(e){const{class:t,panelId:n,hidden:i,allowPanelLink:o,inputId:r,attrs:a,heading:l,helpText:s,errors:c,children:d}=e,u=Ct("div",Object.assign({},function(e,t){const n=Object.assign({},e||{}),i=["panel","collapsible"];n.class&&i.push(n.class),(null==t?void 0:t.class)&&i.push(t.class);let o=n["data-controller"]||"";return o?o.split(" ").includes("panel")||(o+=" panel"):o="panel",n["data-controller"]=o,(null==t?void 0:t.panelId)&&(n["data-panel-panel-value"]=t.panelId),(null==t?void 0:t.inputId)&&(n["data-panel-input-id"]=t.inputId),(null==t?void 0:t.hidden)&&i.push("collapsed"),n.class=i.join(" "),n}(a,{panelId:n,inputId:r,hidden:i,class:t}))),h=i||xt(l)?null:function(e,t=!0,...n){return Ct("div",{class:"panel__heading","data-panel-target":"heading"},e&&t?Ct("a",{class:"panel__icon","data-panel-target":"linkIcon",href:`#${e}`},Dt("icon-link",{class:"link-logo"})):null,Ct("div",Object.assign({class:"panel__title","data-action":"click->panel#toggle"},e?{id:e}:{}),n))}(n,!1!==o,l),p=function(e){if(!e||Array.isArray(e)&&0===e.length)return null;const t=Ct("div",{class:"panel__errors"});if(e instanceof HTMLElement)return t.appendChild(e),t;if(Array.isArray(e))e.forEach(e=>{const n=Ct("li",{class:"panel__error"},e instanceof Error?e.message:String(e));t.appendChild(n)});else{const n=Ct("li",{class:"panel__error"},e instanceof Error?e.message:String(e));t.appendChild(n)}return t}(c),f=i||xt(s)||null==(g=s)?null:Ct("div",{class:"panel__help"},"function"==typeof g?g():g);var g;const m=Array.isArray(d)?_t(...d):_t(d);return u.opts=e,h&&(u.heading=u.appendChild(h)),f&&(u.helpText=u.appendChild(f)),p&&(u.errors=u.appendChild(p)),u.body=u.appendChild(m),u.toggle=function(){const e=window.Stimulus.getControllerForElementAndIdentifier(this,"panel");e&&e.toggle()},u.show=function(){const e=window.Stimulus.getControllerForElementAndIdentifier(this,"panel");e&&e.collapse(!1)},u.hide=function(){const e=window.Stimulus.getControllerForElementAndIdentifier(this,"panel");e&&e.collapse(!0)},u}class Tt{constructor(e={duration:300,easing:"ease"}){this.options=e,e.elements?e.elements instanceof HTMLElement?this.elements=[e.elements]:this.elements=e.elements:this.elements=[]}addElement(...e){e.forEach(e=>{var t,n;null===(n=(t=this.options).onAdded)||void 0===n||n.call(t,e)}),this.elements.push(...e)}start(){this.elements.forEach(e=>{var t,n;null===(n=(t=this.options).onStart)||void 0===n||n.call(t,e),requestAnimationFrame(()=>{e.animate([Object.assign({height:"0px"},this.options.animFrom),Object.assign({height:`${e.offsetHeight}px`},this.options.animTo)],{duration:this.options.duration||300,easing:this.options.easing||"ease",fill:"none"}).onfinish=()=>{var t,n;null===(n=(t=this.options).onFinished)||void 0===n||n.call(t,e)}})})}}function It(e,t={color:"red",duration:200,iters:2,delay:0}){e&&e.animate([{boxShadow:`0 0 0px ${t.color}`},{boxShadow:`0 0 10px ${t.color}`},{boxShadow:`0 0 0px ${t.color}`}],{duration:t.duration,easing:"linear",fill:"none",iterations:t.iters,delay:t.delay,direction:"alternate"})}const Ot={"data-controller":!0,class:!0,style:!0};class Mt extends kt{constructor(e,t,n,i,o,r){var a;o=o||[],r=r||[];const l=At({panelId:`${n}--panel`,class:"sequence-block",allowPanelLink:!0,heading:null!==(a=e.meta.label)&&void 0!==a?a:Ct("div",{class:"sequence-block-field-heading"},Ct("label",{for:i,class:"sequence-block-field-heading-label"},e.meta.label,":")),attrs:{"data-controller":"sortable"}}),s={};for(let e=0;e<t.attributes.length;e++)l.hasAttribute(t.attributes[e].name)||Ot[t.attributes[e].name]||(s[t.attributes[e].name]=t.attributes[e].value);Object.keys(s).forEach(e=>{l.body.setAttribute(e,s[e])}),t.replaceWith(l),super(e,n,l),this.items=[],this.id=i,l.body.appendChild(Ct("button",{type:"button","data-action":"add",class:"sequence-block-add-button",onClick:this._onAddClick.bind(this,null)},Dt("icon-plus",{title:window.i18n.gettext("Add %s",this.block.meta.label||window.i18n.gettext("item"))}))),this.totalInput=l.body.appendChild(Ct("input",{type:"hidden","data-sequence-block-total":!0,name:`${n}--total`,value:String(o.length||0)})),this.itemWrapper=l.body.appendChild(Ct("div",{"data-sequence-block-items":!0,class:"sequence-block-items","data-sortable-target":"items"}));for(let e=0;e<o.length;e++)this._createChild(e,e,i,n,o[e],r[e]||null,!1);this.activeItems=this.items.length}_createChild(e,t,n,i,o,r,a=!0){let l=null;a&&(l=new Tt({duration:300,onAdded:e=>{e.style.transition="opacity 300ms ease"},onFinished:e=>{e.style.transition="",e.style||e.removeAttribute("style")},animFrom:{opacity:"0"},animTo:{opacity:"1"}}));const s=`${n}-${e}`,c=`${i}-${e}`,d=`${i}-id-${e}`,u=`${i}-order-${e}`,h=`${i}-${e}--deleted`,p=`${c}--panel`,f=`${c}--heading-index`,g=Ct("div",{"data-sequence-block-field":!0,id:c+"--block","data-index":String(t),"data-sortable-target":"item","data-replace":`#${u};#${f}+;[data-index]`,class:"sequence-block-field"},Ct("input",{type:"hidden",id:d,name:d,value:o.id}),Ct("input",{type:"hidden",id:u,name:u,value:String(o.order)}),Ct("input",{type:"hidden",id:h,name:h,value:""}),At({panelId:p,heading:Ct("div",{class:"sequence-block-field-heading"},this.block.meta.label?Ct("label",{for:d,class:"sequence-block-field-heading-label"},this.block.meta.label,":"):null,Ct("span",{id:f,class:"sequence-block-field-heading-index"},String(o.order+1))),children:Ct("div",{"data-sequence-block-field-content":!0,class:"sequence-block-field-content"},Ct("div",{"data-sequence-block-field-handle":!0,class:"sequence-block-field-drag-handle"},""),Ct("div",{"data-sequence-block-field-placeholder":!0}),Ct("div",{"data-sequence-block-field-actions":!0,class:"sequence-block-field-actions"},Ct("div",{"data-sequence-block-field-actions-group":!0,class:"sequence-block-field-actions-group"},Ct("div",{"data-sequence-block-field-delete":!0,class:"sequence-block-field-delete"},Ct("button",{type:"button","data-action":"delete",class:"sequence-block-field-delete-button",onClick:this._onDeleteClick.bind(this,c)},Dt("icon-trash"))),Ct("div",{"data-sequence-block-field-add":!0,class:"sequence-block-field-add"},Ct("button",{type:"button","data-action":"add",class:"sequence-block-field-add-button",onClick:this._onAddClick.bind(this,c)},Dt("icon-plus"))))))}));return a&&l.addElement(g),0===t?this.itemWrapper.prepend(g):t>=this.items.length?this.itemWrapper.appendChild(g):this.itemWrapper.insertBefore(g,this.itemWrapper.children[t]),this.items.push(this.block.childBlock.render(g.querySelector("[data-sequence-block-field-placeholder]"),s,c,o.data,r)),a&&l.start(),g}_onDeleteClick(e,t){t.preventDefault();const n=`#${e}--block`,i=this.itemWrapper.querySelector(n);if(!i)return void console.warn("Couldn't find item to delete",n);if(this.activeItems<=1&&this.block.meta.required||this.block.meta.minNum&&this.activeItems<=this.block.meta.minNum)return console.warn("Can't delete item, minimum reached"),void It(i);const o=i.querySelector(`#${e}--deleted`);if(!o)return void console.warn("Couldn't find deleted input",`#${e}--deleted`);i.style.display="none",o.value="1",this.activeItems-=1,It(this.itemWrapper,{color:"orange",duration:300,iters:1,delay:20});const r=window.Stimulus.getControllerForElementAndIdentifier(this.element,"sortable");r?r.reOrderItems():console.warn("Couldn't find sortable controller for list block",this.element)}_onAddClick(e,t){if(t.preventDefault(),this.block.meta.maxNum&&this.activeItems>=this.block.meta.maxNum)return console.warn("Can't add item, maximum reached"),void It(this.itemWrapper);let n=0;if(e){e=`#${e}--block`;const t=this.itemWrapper.querySelector(e);if(!t)return void console.warn("Couldn't find item to add",e);n=parseInt(t.dataset.index||"0",10)+1}It(this._createChild(this.items.length,n,this.id,this.name,{id:"",order:n,data:null},null),{color:"green",duration:300,iters:1,delay:100}),this.totalInput.value=String(this.items.length),this.activeItems+=1}}class Nt extends Et{constructor(e,t,n){super(),this.name=e,this.childBlock=t,this.meta=n}render(e,t,n,i,o){return new Mt(this,e,n,t,i,o)}}class qt extends kt{constructor(e,t,n,i,o,r,a={}){var l,s;const c=Ct("ul",{class:"field-errors"}),d=Ct("div",{class:"field-label"},Ct("label",{for:i},e.meta.label)),u=Ct("div",{class:"field-widget"}),h=At({panelId:`${n}--panel`,class:"field-block",allowPanelLink:!!e.meta.label,heading:d,helpText:null!==(l=e.meta.helpText)&&void 0!==l?l:Ct("div",{class:"field-help"},e.meta.helpText),errors:c,children:u});t.replaceWith(h),super(e,n,h),this.errorList=c,this.labelWrapper=d,this.attrs=a;const p={attributes:this.getAttributes()};o=null!==(s=null!=o?o:e.meta.default)&&void 0!==s?s:null,this.widget=e.widget.render(u,n,i,o,p),r&&this.setError(r)}getAttributes(){const e=this.attrs||{};return this.block.meta.required&&(e.required="required"),e}getLabel(){return this.widget.getTextLabel()}getState(){return this.widget.getState()}setState(e){this.widget.setState(e)}getValue(){return this.widget.getValue()}setValue(e){this.widget.setValue(e)}setError(e){if(e&&0!==(null==e?void 0:e.length))if(Array.isArray(e)){if(!e.length)return void(this.errorList.innerHTML="");this.errorList.innerHTML="",e.forEach(e=>{const t=Ct("li",null,e);this.errorList.appendChild(t)})}else if("object"==typeof e){var t=Object.keys(e);if(this.errorList.innerHTML="",!t.length)return;t.forEach(t=>{e[t].forEach(e=>{const t=Ct("li",null,e);this.errorList.appendChild(t)})})}else this.errorList.innerHTML="",this.errorList.appendChild(Ct("li",null,e))}}class Pt extends Et{constructor(e,t,n){super(),this.name=e,this.widget=t,this.meta=n}render(e,t,n,i,o,r={}){return new qt(this,e,n,t,i,o,r)}}class $t extends kt{constructor(e,t,n,i,o,r){var a;let l=null;e.meta.label&&(l=Ct("div",{class:"field-label"},Ct("label",null,e.meta.label)));let s=null;r&&r.nonFieldErrors&&(s=Ct("ul",{class:"field-errors"},r.nonFieldErrors.map(e=>Ct("li",{class:"field-error"},e))));const c=Ct("div",{"data-struct-block-children":!0}),d=At({panelId:`${n}--panel`,class:"field-block",allowPanelLink:!!e.meta.label,heading:l,helpText:null!==(a=e.meta.helpText)&&void 0!==a?a:Ct("div",{class:"field-help"},e.meta.helpText),errors:s,children:c});t.replaceWith(d),super(e,n,d),this.element.dataset.structBlock="true",this.childBlocks={},o=o||{},r=r||{};var u=Object.keys(e.children);for(let t=0;t<u.length;t++){const n=u[t],a=e.children[n],l=this.name+"-"+n,s=i+"-"+n,d=Ct("div",{"data-struct-field":!0,"data-contentpath":l},Ct("div",{"data-struct-field-content":!0},Ct("div",{"data-struct-field-content-placeholder":!0})));c.appendChild(d),this.childBlocks[l]=a.render(d.firstElementChild.firstElementChild,s,l,o[n],r[n])}}getLabel(){for(let e=0;e<this.block.config.childBlocks.length;e++){let t=this.block.config.childBlocks[e].getLabel();if(t)return t}return""}getState(){const e={};for(const t in this.childBlocks)e[t]=this.childBlocks[t].getState();return e}setState(e){for(const t in this.childBlocks)this.childBlocks[t].setState(e[t])}setError(e){if(e){if(e.blockErrors)for(const t in e.blockErrors)this.childBlocks[t].setError(e.blockErrors[t]);e.nonFieldErrors&&(this.element.style.backgroundColor="red")}}}class Lt extends Et{constructor(e,t,n){super(),this.name=e,this.meta=n,this.children={};for(let e=0;e<t.length;e++)this.children[t[e].name]=t[e].block}render(e,t,n,i,o){return new $t(this,e,n,t,i,o)}}class Bt extends Error{constructor(e){super(`No input found with name "${e}"`),this.name="InputNotFoundError"}}class jt{constructor(e,t){this.idForLabel=null;const n=`:is(input,select,textarea,button)[name="${t}"]`;if(this.input=((e,t)=>{const n=e.forEach?e:[e];for(let e=0;e<n.length;e+=1){const i=n[e];if(i.nodeType===Node.ELEMENT_NODE){if(i.matches(t))return i;const e=i.querySelector(t);if(e)return e}}return null})(e,n),!this.input)throw new Bt(t);this.idForLabel=this.input.id}getState(){return this.input.value}getValue(){return this.input.value}setState(e){this.input.value=e}setValue(e){this.input.value=e}focus(){this.input.focus()}getValueForLabel(){return this.getValue()}getTextLabel(e){const t=this.getValueForLabel();if(!["string","number","boolean"].includes(typeof t))return null;const n=String(t).trim(),i=e&&e.maxLength;return i&&n.length>i?n.substring(0,i-1)+"":n}}class Wt{constructor(e){this.boundWidgetClass=jt,this.html=e}render(e,t,n,i,o={}){const r=this.html.replace(/__NAME__/g,t).replace(/__ID__/g,n),a=document.createElement("div");a.innerHTML=r;const l=Array.from(a.childNodes);e.replaceWith(...l);const s=l.filter(e=>e.nodeType===Node.ELEMENT_NODE);if("object"==typeof(null==o?void 0:o.attributes))for(const[e,t]of Object.entries(o.attributes))s[0].setAttribute(e,t);const c=new this.boundWidgetClass(1===s.length?s[0]:l,t);return c.setState(i),c}}class Ft extends jt{getState(){return this.input.checked}getValue(){return this.input.checked}setState(e){this.input.checked=Boolean(e)}setValue(e){this.input.checked=Boolean(e)}getValueForLabel(){return this.getValue()?window.i18n.gettext("Yes"):window.i18n.gettext("No")}}class Rt{constructor(e,t){this.element=e,this.name=t,this.idForLabel="",this.isMultiple=!!this.element.querySelector(`input[name="${t}"][type="checkbox"]`),this.selector=`input[name="${t}"]:checked`}getValueForLabel(){const e=e=>Array.from((null==e?void 0:e.labels)||[]).map(e=>e.textContent.trim()).filter(Boolean).join(", ");return this.isMultiple?Array.from(this.element.querySelectorAll(this.selector)).map(e).join(", "):e(this.element.querySelector(this.selector))}getTextLabel(){return this.getValueForLabel()}getValue(){var e;return this.isMultiple?Array.from(this.element.querySelectorAll(this.selector)).map(e=>e.value):null===(e=this.element.querySelector(this.selector))||void 0===e?void 0:e.value}getState(){return Array.from(this.element.querySelectorAll(this.selector)).map(e=>e.value)}setState(e){const t=this.element.querySelectorAll(`input[name="${this.name}"]`);for(let n=0;n<t.length;n+=1)t[n].checked=e.includes(t[n].value)}setInvalid(e){this.element.querySelectorAll(`input[name="${this.name}"]`).forEach(t=>{e?t.setAttribute("aria-invalid","true"):t.removeAttribute("aria-invalid")})}focus(){var e;null===(e=this.element.querySelector(`input[name="${this.name}"]`))||void 0===e||e.focus()}}class Yt extends jt{getValueForLabel(){return Array.from(this.input.selectedOptions).map(e=>e.text).join(", ")}getValue(){return this.input.multiple?Array.from(this.input.selectedOptions).map(e=>e.value):this.input.value}getState(){return Array.from(this.input.selectedOptions).map(e=>e.value)}setState(e){const t=this.input.options;for(let n=0;n<t.length;n+=1)t[n].selected=e.includes(t[n].value)}}class Xt extends kt{constructor(e,t,n,i,o,r){var a;o=o||[],r=r||[];const l=At({panelId:`${n}--panel`,class:"sequence-block",allowPanelLink:!!e.meta.label,heading:null!==(a=e.meta.label)&&void 0!==a?a:Ct("div",{class:"sequence-block-field-heading"},Ct("label",{for:i,class:"sequence-block-field-heading-label"},e.meta.label,":")),attrs:{"data-controller":"sortable"}});t.replaceWith(l),super(e,n,l),this.items=[],this.id=i,l.body.appendChild(Ct("div",{"data-controller":"dropdown",class:"sequence-block-add-dropdown dropdown"},Ct("button",{type:"button","data-action":"add",class:"sequence-block-add-button","data-dropdown-target":"toggle","aria-label":window.i18n.gettext("Add %s",this.block.meta.label||window.i18n.gettext("item")),"aria-expanded":"false"},Dt("icon-plus",{title:window.i18n.gettext("Add %s",this.block.meta.label||window.i18n.gettext("item"))})),Ct("div",{"data-dropdown-target":"content",class:"dropdown__content"},Object.keys(this.block.childBlocks).map(e=>Ct("button",{type:"button",class:"sequence-block-add-type-button",onClick:this._onAddClick.bind(this,null,e),"data-block-type":e,"data-action":"click->dropdown#hide"},this.block.childBlocks[e].meta.label||e))))),this.totalInput=l.body.appendChild(Ct("input",{type:"hidden","data-sequence-block-total":!0,name:`${n}--total`,value:String((null==o?void 0:o.length)||0)})),this.itemWrapper=l.body.appendChild(Ct("div",{"data-sequence-block-items":!0,class:"sequence-block-items","data-sortable-target":"items"}));for(let e=0;e<((null==o?void 0:o.length)||0);e++)this._createChild(e,e,i,n,o[e],r[e]||null,!1)}_createChild(e,t,n,i,o,r,a=!0){var l=this.block.childBlocks[o.type];if(!l)return void console.error(`No child block of type ${o.type} found in StreamBlock ${this.block.name}`);o.data||(o.data=this.block.defaults[o.type]||null);let s=null;a&&(s=new Tt({duration:300,onAdded:e=>{e.style.transition="opacity 300ms ease"},onFinished:e=>{e.style.transition="",e.style||e.removeAttribute("style")},animFrom:{opacity:"0"},animTo:{opacity:"1"}}));const c=`${n}-${e}`,d=`${i}-${e}`,u=`${i}-id-${e}`,h=`${i}-order-${e}`,p=`${i}-${e}--deleted`,f=`${i}-${e}--type`,g=`${d}--panel`,m=`${d}--heading-index`,v=Ct("div",{"data-sequence-block-field":!0,id:d+"--block","data-index":String(t),"data-sortable-target":"item","data-replace":`#${h};#${m}+;[data-index]`,class:"sequence-block-field"},Ct("input",{type:"hidden",id:u,name:u,value:o.id}),Ct("input",{type:"hidden",id:h,name:h,value:String(t)}),Ct("input",{type:"hidden",id:p,name:p,value:""}),Ct("input",{type:"hidden",id:f,name:f,value:o.type}),At({panelId:g,heading:Ct("div",{class:"sequence-block-field-heading"},l.meta.label?Ct("label",{for:u,class:"sequence-block-field-heading-label"},l.meta.label,":"):null,Ct("span",{id:m,class:"sequence-block-field-heading-index"},String(t+1))),children:Ct("div",{"data-sequence-block-field-content":!0,class:"sequence-block-field-content"},Ct("div",{"data-sequence-block-field-handle":!0,class:"sequence-block-field-drag-handle"},""),Ct("div",{"data-sequence-block-field-placeholder":!0}),Ct("div",{"data-sequence-block-field-actions":!0,class:"sequence-block-field-actions"},Ct("div",{"data-sequence-block-field-actions-group":!0,class:"sequence-block-field-actions-group"},Ct("div",{"data-sequence-block-field-delete":!0,class:"sequence-block-field-delete"},Ct("button",{type:"button","data-action":"delete",class:"sequence-block-field-delete-button",onClick:this._onDeleteClick.bind(this,d)},Dt("icon-trash"))),Ct("div",{"data-sequence-block-field-add":!0,class:"sequence-block-field-add"},Ct("button",{type:"button","data-action":"add",class:"sequence-block-field-add-button",onClick:this._onAddClick.bind(this,d)},Dt("icon-plus"))))))}));a&&s.addElement(v),0===t?this.itemWrapper.prepend(v):t>=this.items.length?this.itemWrapper.appendChild(v):this.itemWrapper.insertBefore(v,this.itemWrapper.children[t]);const b={id:o.id,type:o.type,block:l.render(v.querySelector("[data-sequence-block-field-placeholder]"),c,d,o.data,r)};return this.items.push(b),a&&s.start(),v}_onDeleteClick(e,t){t.preventDefault();const n=`#${e}--block`,i=this.itemWrapper.querySelector(n);if(!i)return void console.warn("Couldn't find item to delete",n);if(this.activeItems<=1&&this.block.meta.required||this.block.meta.minNum&&this.activeItems<=this.block.meta.minNum)return console.warn("Can't delete item, minimum reached"),void It(i);const o=i.querySelector(`#${e}--deleted`);if(!o)return void console.warn("Couldn't find deleted input",`#${e}--deleted`);i.style.display="none",o.value="1",this.activeItems-=1,It(this.itemWrapper,{color:"orange",duration:300,iters:1,delay:20});const r=window.Stimulus.getControllerForElementAndIdentifier(this.element,"sortable");r?r.reOrderItems():console.warn("Couldn't find sortable controller for list block",this.element)}_onAddClick(e,t,n){if(n.preventDefault(),this.block.meta.maxNum&&this.activeItems>=this.block.meta.maxNum)return console.warn("Can't add item, maximum reached"),void It(this.itemWrapper);let i=0;if(e){e=`#${e}--block`;const t=this.itemWrapper.querySelector(e);if(!t)return void console.warn("Couldn't find item to add",e);i=parseInt(t.dataset.index||"0",10)+1}const o={id:"",type:t,data:null};this.block.defaults[t]&&(o.data=this.block.defaults[t]),It(this._createChild(this.items.length,i,this.id,this.name,o,null),{color:"green",duration:300,iters:1,delay:100}),this.totalInput.value=String(this.items.length),this.activeItems+=1}}class Vt extends Et{constructor(e,t,n,i){super(),this.name=e,this.meta=i,this.childBlocks={},this.defaults=n;for(let e=0;e<t.length;e++)this.childBlocks[t[e].name]=t[e].block}render(e,t,n,i,o){return new Xt(this,e,n,t,i,o)}}window.blocks=new class{constructor(e){this.blocks={},this.blocks=e||{},wt.classRegistry=this.blocks}registerBlock(e,t){this.blocks[e]=t}initBlock(...e){return new(0,this.blocks[e.blockType])(...e)}},window.telepath.register("django.widgets.Widget",Wt),window.telepath.register("django.widgets.SelectWidget",class extends Wt{constructor(){super(...arguments),this.boundWidgetClass=Yt}}),window.telepath.register("django.widgets.RadioSelect",class extends Wt{constructor(){super(...arguments),this.boundWidgetClass=Rt}}),window.telepath.register("django.widgets.CheckboxInput",class extends Wt{constructor(){super(...arguments),this.boundWidgetClass=Ft}}),window.telepath.register("django.blocks.FieldBlock",Pt),window.blocks.registerBlock("django.blocks.field-block",Pt),window.telepath.register("django.blocks.ListBlock",Nt),window.blocks.registerBlock("django.blocks.list-block",Nt),window.telepath.register("django.blocks.StructBlock",Lt),window.blocks.registerBlock("django.blocks.struct-block",Lt),window.telepath.register("django.blocks.StreamBlock",Vt),window.blocks.registerBlock("django.blocks.stream-block",Vt),window.AdminSite.registerController("sortable",bt),window.AdminSite.registerController("block",wt)})();
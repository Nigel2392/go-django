// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc {{ .SQLCVersion }}

package {{ .PackageName }};

import (
    "github.com/Nigel2392/go-django/src/core/attrs"
    "github.com/Nigel2392/go-django/src/forms/widgets"

    "database/sql"
)

var (
    _ widgets.Widget
    globalDB *sql.DB
)

func SetDB(db *sql.DB) {
    globalDB = db
}
{{ $obj := . }}
{{ range $choices := $obj.Choices }}
var {{ $choices.Name }}Options = func() []widgets.Option {
    var options = make([]widgets.Option, {{ len $choices.Choices }})
    {{ range $i, $option := $choices.Choices }}
    options[{{ $i }}] = widgets.NewOption("{{ $option.Value }}", "{{ label $option.Name }}", "{{ $option.Value }}"){{ end }}
    return options
}
{{ end }}
{{ range $struct := $obj.Structs }}
func (o *{{ $struct.Name }}) FieldDefs() attrs.Definitions {
    var fields = make([]attrs.Field, {{ len $struct.Fields }})
    {{ range $i, $field := $struct.Fields }}{{ if $field.Choices }}
    var {{$field.Choices}}Widget = widgets.NewSelectInput(
        nil, {{ $field.Choices }}Options,
    ){{ end }}
    fields[{{ $i }}] = attrs.NewField(
        o, "{{ $field.Name }}", &attrs.FieldConfig{
            Null: {{ $field.Null }},
            Blank: {{ $field.Blank }},
            ReadOnly: {{ $field.ReadOnly }},{{ if $field.RelatedObjectName }}
            RelatedObject: &{{ $field.RelatedObjectName }}{},{{ end }}
            Label: "{{ label $field.Name }}",
            Primary: {{ $field.Primary }},{{ if $field.Choices }}
            FormWidget: func(attrs.FieldConfig) widgets.Widget {
                return {{$field.Choices}}Widget
            },{{ end }}
        },
    ){{ end }}
    return attrs.Define(o, fields...)
}
{{ end }}
